2025-04-27 20:32:39.363 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 20:33:07.527 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 20:33:10.270 | INFO     | MainThread      | __main__:main:149 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 20:33:10.271 | INFO     | MainThread      | __main__:load_strategy:33 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 20:33:10.271 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 20:33:10.271 | INFO     | MainThread      | __main__:load_strategy:40 | 成功加载并实例化策略: MyStrategy
2025-04-27 20:33:10.271 | INFO     | MainThread      | __main__:main:169 | 创建回测引擎...
2025-04-27 20:33:10.275 | INFO     | MainThread      | __main__:main:188 | 开始回测策略 'MyStrategy'...
2025-04-27 20:33:10.276 | CRITICAL | MainThread      | __main__:<module>:235 | 程序顶层捕获到未处理异常: name 'time' is not defined
2025-04-27 20:33:10.278 | CRITICAL | MainThread      | __main__:<module>:236 | Traceback (most recent call last):
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 231, in <module>
    asyncio.run(main())
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 189, in main
    start_time = time.time()
                 ^^^^
NameError: name 'time' is not defined. Did you forget to import 'time'

2025-04-27 20:33:10.278 | INFO     | MainThread      | __main__:<module>:239 | 回测程序执行完毕。
2025-04-27 20:33:37.647 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 20:33:39.458 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 20:33:39.458 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 20:33:39.459 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 20:33:39.459 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 20:33:39.459 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 20:33:39.461 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 20:33:39.461 | INFO     | MainThread      | backtest.engine:_initialize_connections:104 | 初始化数据库连接...
2025-04-27 20:33:39.462 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 20:33:39.463 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 20:33:39.463 | INFO     | MainThread      | backtest.engine:_prepare_data:277 | [BTC/USDT:USDT] 准备数据...
2025-04-27 20:33:39.467 | INFO     | MainThread      | backtest.engine:_prepare_data:308 | [BTC/USDT:USDT] 从数据库加载了 269 条 K 线数据。
2025-04-27 20:33:39.469 | INFO     | MainThread      | backtest.engine:_prepare_data:359 | 数据准备完成。共 269 行数据，覆盖 269 个时间点。
2025-04-27 20:33:39.470 | INFO     | MainThread      | backtest.engine:_run_event_loop:372 | 开始运行回测事件循环...
2025-04-27 20:33:39.471 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 20:33:39.471 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 20:33:39.475 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 20:33:39.477 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 20:33:39.478 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 20:33:39.479 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 20:33:39.481 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 20:33:39.482 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 20:33:39.483 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 20:33:39.484 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 20:33:39.485 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 20:33:39.487 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 20:33:39.488 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 20:33:39.489 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 20:33:39.490 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 20:33:39.492 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 20:33:39.493 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 20:33:39.494 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 20:33:39.495 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 20:33:39.496 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 20:33:39.498 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 20:33:39.499 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 20:33:39.500 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 20:33:39.502 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 20:33:39.503 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 20:33:39.505 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 20:33:39.506 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 20:33:39.507 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 20:33:39.509 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 20:33:39.510 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 20:33:39.511 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 20:33:39.512 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 20:33:39.514 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 20:33:39.515 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 20:33:39.516 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 20:33:39.517 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 20:33:39.519 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 20:33:39.520 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 20:33:39.521 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 20:33:39.522 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 20:33:39.524 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 20:33:39.525 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 20:33:39.525 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 20:33:39.527 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 20:33:39.528 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 20:33:39.530 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.531 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.533 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.535 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.537 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.538 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.539 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.541 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.543 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.544 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.546 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.547 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.549 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.550 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.552 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.553 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.555 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.556 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.558 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.559 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.561 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.563 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.564 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.565 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.567 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.568 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.569 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.571 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.572 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.574 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.575 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.577 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.578 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.580 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.581 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.582 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.584 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.585 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.587 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.588 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.590 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.591 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.592 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.594 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.595 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.596 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.598 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.599 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.600 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.602 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.604 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.604 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.607 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.608 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.609 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.611 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.612 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.614 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.615 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.617 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.618 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.619 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.621 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.622 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.624 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.625 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.627 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.628 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.630 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.631 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.633 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.635 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.636 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.637 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.638 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.640 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.642 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.643 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.645 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.646 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.648 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.649 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.651 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.651 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.653 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.655 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.656 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.658 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.659 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.661 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.662 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.664 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.666 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.667 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.668 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.670 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.672 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.673 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.675 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.677 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.678 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.680 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.681 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.683 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.684 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.686 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.688 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.689 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.690 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.692 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.693 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.695 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.696 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.697 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.699 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.701 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.702 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.704 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.706 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.707 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.708 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.710 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.711 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.713 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.714 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.716 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.718 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.719 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.721 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.722 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.724 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.725 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.727 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.728 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.730 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.731 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.732 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.734 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.735 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.736 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.738 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.739 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.741 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.742 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.744 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.746 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.747 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.749 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.750 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.751 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.753 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.755 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.756 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.758 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.759 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.761 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.762 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.764 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.765 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.766 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.768 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.769 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.771 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.772 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.773 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.775 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.776 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.778 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.779 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.781 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.783 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.784 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.785 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.787 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.788 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.790 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.792 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.793 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.794 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.796 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.797 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.799 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.800 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.802 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.804 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.804 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.806 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.808 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.810 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.811 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.813 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.814 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.816 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.818 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.818 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.820 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.822 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.823 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.825 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.826 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.828 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.829 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.831 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.832 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.834 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.835 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.836 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.838 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.839 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.841 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.842 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.844 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.846 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.847 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.849 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.850 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.852 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.853 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.855 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.856 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.858 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.859 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.861 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.863 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.864 | ERROR    | MainThread      | strategies.mystrategy:generate_signals:357 | [BTC/USDT:USDT] 生成信号时发生错误: <class 'tuple'> is not convertible to datetime, at position 0
2025-04-27 20:33:39.865 | INFO     | MainThread      | backtest.engine:_run_event_loop:422 | 回测事件循环完成。耗时: 0.40 秒。
2025-04-27 20:33:39.865 | INFO     | MainThread      | backtest.engine:_calculate_results:764 | 计算回测结果...
2025-04-27 20:33:40.642 | ERROR    | MainThread      | backtest.engine:run:797 | 回测过程中发生严重错误: float division by zero
2025-04-27 20:33:40.643 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 20:33:40.643 | CRITICAL | MainThread      | __main__:<module>:236 | 程序顶层捕获到未处理异常: name 'traceback' is not defined
2025-04-27 20:33:40.646 | CRITICAL | MainThread      | __main__:<module>:237 | Traceback (most recent call last):
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\engine.py", line 794, in run
    results = self._calculate_results()  # 同步计算结果
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\engine.py", line 776, in _calculate_results
    metrics = calculate_metrics(equity_series, trades_df, self.initial_capital)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\results.py", line 44, in calculate_metrics
    "年化回报 (%)": qs.stats.cagr(returns) * 100 if not returns.empty else 0.0,
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qingf\AppData\Roaming\Python\Python312\site-packages\quantstats\stats.py", line 526, in cagr
    res = abs(total + 1.0) ** (1.0 / years) - 1
                               ~~~~^~~~~~~
ZeroDivisionError: float division by zero

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 232, in <module>
    asyncio.run(main())
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 191, in main
    results = await engine.run()  # 运行异步回测
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\engine.py", line 798, in run
    logger.error(traceback.format_exc())
                 ^^^^^^^^^
NameError: name 'traceback' is not defined. Did you forget to import 'traceback'

2025-04-27 20:33:40.647 | INFO     | MainThread      | __main__:<module>:240 | 回测程序执行完毕。
2025-04-27 21:04:45.092 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:04:47.028 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:04:47.028 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:04:47.028 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:04:47.028 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:04:47.028 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:04:47.030 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:04:47.030 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:04:47.031 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:04:47.032 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:04:47.032 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:04:47.036 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 259 条 K 线数据。
2025-04-27 21:04:47.037 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 259 行数据，覆盖 259 个时间点。
2025-04-27 21:04:47.037 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:04:47.038 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:04:47.038 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:04:47.039 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:04:47.040 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:04:47.041 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:04:47.042 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:04:47.043 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:04:47.044 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:04:47.045 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:04:47.046 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:04:47.047 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:04:47.047 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:04:47.048 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:04:47.049 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:04:47.050 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:04:47.051 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:04:47.052 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:04:47.053 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:04:47.054 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:04:47.055 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:04:47.056 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:04:47.056 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:04:47.058 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:04:47.058 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:04:47.059 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:04:47.060 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:04:47.061 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:04:47.062 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:04:47.063 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:04:47.064 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:04:47.066 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:04:47.067 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:04:47.068 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:04:47.069 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:04:47.070 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:04:47.071 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:04:47.072 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:04:47.073 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:04:47.073 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:04:47.074 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:04:47.075 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:04:47.077 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:04:47.077 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:04:47.078 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:04:47.079 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:04:47.676 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 0.64 秒。
2025-04-27 21:04:47.676 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:04:47.679 | WARNING  | MainThread      | backtest.results:calculate_metrics:55 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:04:47.679 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:04:47.679 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 0.65 秒。
2025-04-27 21:04:47.680 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:04:47.681 | CRITICAL | MainThread      | __main__:<module>:236 | 程序顶层捕获到未处理异常: generate_report_html() missing 1 required positional argument: 'strategy_name'
2025-04-27 21:04:47.682 | CRITICAL | MainThread      | __main__:<module>:237 | Traceback (most recent call last):
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 232, in <module>
    asyncio.run(main())
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 206, in main
    generate_report_html(
TypeError: generate_report_html() missing 1 required positional argument: 'strategy_name'

2025-04-27 21:04:47.683 | INFO     | MainThread      | __main__:<module>:240 | 回测程序执行完毕。
2025-04-27 21:12:04.281 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:12:05.821 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:12:05.821 | WARNING  | MainThread      | __main__:main:157 | 开启了 --fetch-missing 但未提供完整的 --exchange, --api-key, --secret-key。将禁用数据获取。
2025-04-27 21:12:05.822 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:12:05.822 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:12:05.822 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:12:05.822 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:12:05.824 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:12:05.824 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:12:05.825 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:12:05.825 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:12:05.826 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:12:05.829 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 256 条 K 线数据。
2025-04-27 21:12:05.830 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 256 行数据，覆盖 256 个时间点。
2025-04-27 21:12:05.830 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:12:05.831 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:12:05.831 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:12:05.832 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:12:05.833 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:12:05.834 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:12:05.835 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:12:05.836 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:12:05.837 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:12:05.837 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:12:05.838 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:12:05.839 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:12:05.840 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:12:05.841 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:12:05.841 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:12:05.842 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:12:05.843 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:12:05.844 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:12:05.845 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:12:05.846 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:12:05.847 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:12:05.847 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:12:05.848 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:12:05.849 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:12:05.850 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:12:05.850 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:12:05.851 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:12:05.852 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:12:05.853 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:12:05.853 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:12:05.854 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:12:05.855 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:12:05.857 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:12:05.857 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:12:05.858 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:12:05.859 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:12:05.860 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:12:05.861 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:12:05.862 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:12:05.863 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:12:05.863 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:12:05.864 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:12:05.865 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:12:05.866 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:12:05.867 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:12:05.868 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:12:06.323 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 0.49 秒。
2025-04-27 21:12:06.323 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:12:06.325 | WARNING  | MainThread      | backtest.results:calculate_metrics:55 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:12:06.325 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:12:06.325 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 0.50 秒。
2025-04-27 21:12:06.326 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:12:06.327 | CRITICAL | MainThread      | __main__:<module>:236 | 程序顶层捕获到未处理异常: generate_report_html() missing 1 required positional argument: 'strategy_name'
2025-04-27 21:12:06.328 | CRITICAL | MainThread      | __main__:<module>:237 | Traceback (most recent call last):
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 232, in <module>
    asyncio.run(main())
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest\backtester_cli.py", line 206, in main
    generate_report_html(
TypeError: generate_report_html() missing 1 required positional argument: 'strategy_name'

2025-04-27 21:12:06.328 | INFO     | MainThread      | __main__:<module>:240 | 回测程序执行完毕。
2025-04-27 21:12:44.872 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:12:46.445 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:12:46.446 | WARNING  | MainThread      | __main__:main:157 | 开启了 --fetch-missing 但未提供完整的 --exchange, --api-key, --secret-key。将禁用数据获取。
2025-04-27 21:12:46.446 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:12:46.446 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:12:46.446 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:12:46.446 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:12:46.448 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:12:46.448 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:12:46.450 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:12:46.451 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:12:46.451 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:12:46.454 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 256 条 K 线数据。
2025-04-27 21:12:46.455 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 256 行数据，覆盖 256 个时间点。
2025-04-27 21:12:46.455 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:12:46.457 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:12:46.457 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:12:46.458 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:12:46.459 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:12:46.460 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:12:46.460 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:12:46.461 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:12:46.462 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:12:46.463 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:12:46.464 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:12:46.464 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:12:46.465 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:12:46.466 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:12:46.467 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:12:46.468 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:12:46.469 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:12:46.470 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:12:46.470 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:12:46.472 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:12:46.472 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:12:46.474 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:12:46.474 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:12:46.475 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:12:46.475 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:12:46.476 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:12:46.477 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:12:46.478 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:12:46.479 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:12:46.481 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:12:46.481 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:12:46.482 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:12:46.484 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:12:46.485 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:12:46.486 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:12:46.487 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:12:46.487 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:12:46.488 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:12:46.489 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:12:46.490 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:12:46.491 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:12:46.491 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:12:46.492 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:12:46.494 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:12:46.495 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:12:46.496 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:12:46.972 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 0.52 秒。
2025-04-27 21:12:46.972 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:12:46.974 | WARNING  | MainThread      | backtest.results:calculate_metrics:55 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:12:46.974 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:12:46.974 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 0.53 秒。
2025-04-27 21:12:46.975 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:12:46.975 | WARNING  | MainThread      | backtest.results:generate_report_html:174 | 收益率序列为空或全为零，无法生成 quantstats 报告。
2025-04-27 21:12:46.976 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:16:16.969 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:16:18.571 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:16:18.572 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:16:18.572 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:16:18.572 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:16:18.572 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:16:18.574 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:16:18.574 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:16:18.575 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:16:18.576 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:16:18.576 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:16:18.576 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:16:18.580 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:16:19.850 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:16:19.851 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:16:19.851 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:16:19.851 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:16:19.892 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 255 条 K 线数据。
2025-04-27 21:16:19.893 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 11:17:59.999000+00:00 的数据。
2025-04-27 21:16:19.893 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 11:17:59.999000+00:00)
2025-04-27 21:16:21.524 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 226 条获取到的 K 线存入数据库。
2025-04-27 21:16:21.526 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 481 条。
2025-04-27 21:16:21.527 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 481 行数据，覆盖 481 个时间点。
2025-04-27 21:16:21.527 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:16:21.529 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:16:21.529 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:16:21.530 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:16:21.531 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:16:21.532 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:16:21.533 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:16:21.534 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:16:21.534 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:16:21.536 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:16:21.536 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:16:21.537 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:16:21.538 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:16:21.539 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:16:21.540 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:16:21.541 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:16:21.542 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:16:21.543 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:16:21.544 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:16:21.544 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:16:21.545 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:16:21.546 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:16:21.547 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:16:21.548 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:16:21.549 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:16:21.549 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:16:21.550 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:16:21.551 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:16:21.553 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:16:21.553 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:16:21.554 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:16:21.555 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:16:21.555 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:16:21.556 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:16:21.557 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:16:21.558 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:16:21.559 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:16:21.560 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:16:21.561 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:16:21.562 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:16:21.563 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:16:21.564 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:16:21.564 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:16:21.565 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:16:21.566 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:16:21.567 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:16:22.562 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 1.03 秒。
2025-04-27 21:16:22.562 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:16:22.563 | WARNING  | MainThread      | backtest.results:calculate_metrics:55 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:16:22.564 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:16:22.564 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:16:22.816 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:16:22.816 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.24 秒。
2025-04-27 21:16:22.817 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:16:22.818 | WARNING  | MainThread      | backtest.results:generate_report_html:174 | 收益率序列为空或全为零，无法生成 quantstats 报告。
2025-04-27 21:16:22.819 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:16:44.579 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:16:46.124 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:16:46.124 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:16:46.124 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:16:46.124 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:16:46.125 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:16:46.127 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:16:46.127 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:16:46.127 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:16:46.128 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:16:46.129 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:16:46.129 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:16:46.133 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:16:47.621 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:16:47.621 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:16:47.622 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:16:47.622 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:16:47.626 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 735 条 K 线数据。
2025-04-27 21:16:47.626 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 11:17:59.999000+00:00 的数据。
2025-04-27 21:16:47.626 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 11:17:59.999000+00:00)
2025-04-27 21:16:49.075 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 226 条获取到的 K 线存入数据库。
2025-04-27 21:16:49.076 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 21:16:49.078 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 21:16:49.078 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:16:49.079 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:16:49.079 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:16:49.080 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:16:49.081 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:16:49.082 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:16:49.083 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:16:49.084 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:16:49.085 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:16:49.086 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:16:49.087 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:16:49.088 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:16:49.089 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:16:49.090 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:16:49.091 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:16:49.091 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:16:49.093 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:16:49.093 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:16:49.094 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:16:49.095 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:16:49.096 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:16:49.097 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:16:49.098 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:16:49.098 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:16:49.100 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:16:49.101 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:16:49.101 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:16:49.103 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:16:49.104 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:16:49.105 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:16:49.105 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:16:49.106 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:16:49.107 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:16:49.108 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:16:49.109 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:16:49.110 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:16:49.111 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:16:49.112 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:16:49.113 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:16:49.114 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:16:49.115 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:16:49.116 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:16:49.117 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:16:49.118 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:16:49.119 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:16:49.120 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:16:51.246 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.17 秒。
2025-04-27 21:16:51.247 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:16:51.249 | WARNING  | MainThread      | backtest.results:calculate_metrics:55 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:16:51.249 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:16:51.250 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:16:51.502 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:16:51.502 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.37 秒。
2025-04-27 21:16:51.503 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:16:51.504 | WARNING  | MainThread      | backtest.results:generate_report_html:174 | 收益率序列为空或全为零，无法生成 quantstats 报告。
2025-04-27 21:16:51.505 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:39:25.294 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:39:27.392 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:39:27.393 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:39:27.393 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:39:27.394 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:39:27.394 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:39:27.394 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:39:27.396 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:39:27.396 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:39:27.397 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:39:27.398 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:39:27.398 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:39:27.399 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:39:27.403 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:39:29.049 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:39:29.049 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:39:29.050 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:39:29.050 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:39:29.054 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 727 条 K 线数据。
2025-04-27 21:39:29.055 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 11:41:59.999000+00:00 的数据。
2025-04-27 21:39:29.055 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 11:41:59.999000+00:00)
2025-04-27 21:39:30.328 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 234 条获取到的 K 线存入数据库。
2025-04-27 21:39:30.330 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 21:39:30.331 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 21:39:30.331 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:39:31.009 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 21:39:31.018 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94471.0000, 当前价: 94293.9000
2025-04-27 21:39:31.593 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 21:39:31.597 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94842.1000, 当前价: 94771.3000
2025-04-27 21:39:32.773 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.44 秒。
2025-04-27 21:39:32.773 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:39:32.776 | ERROR    | MainThread      | backtest.engine:_calculate_results:1021 | 计算结果时出错: module 'quantstats.utils' has no attribute 'determine_years'
2025-04-27 21:39:32.776 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:39:32.776 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:39:33.032 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:39:33.032 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.64 秒。
2025-04-27 21:39:33.033 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 结果计算失败: module 'quantstats.utils' has no attribute 'determine_years'
2025-04-27 21:39:33.034 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:43:37.329 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:43:38.933 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:43:38.933 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:43:38.933 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:43:38.934 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:43:38.934 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:43:38.934 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:43:38.935 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:43:38.935 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:43:38.935 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:43:38.937 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:43:38.937 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:43:38.937 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:43:38.941 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:43:40.301 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:43:40.301 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:43:40.301 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:43:40.302 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:43:40.305 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 726 条 K 线数据。
2025-04-27 21:43:40.305 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 11:44:59.999000+00:00 的数据。
2025-04-27 21:43:40.306 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 11:44:59.999000+00:00)
2025-04-27 21:43:41.573 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 235 条获取到的 K 线存入数据库。
2025-04-27 21:43:41.574 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 21:43:41.575 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 21:43:41.575 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:43:42.170 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 21:43:42.176 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94471.0000, 当前价: 94293.9000
2025-04-27 21:43:42.733 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 21:43:42.737 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94842.1000, 当前价: 94771.3000
2025-04-27 21:43:43.937 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.36 秒。
2025-04-27 21:43:43.938 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:43:43.940 | ERROR    | MainThread      | backtest.engine:_calculate_results:1021 | 计算结果时出错: name 'determine_years' is not defined
2025-04-27 21:43:43.940 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:43:43.941 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:43:44.191 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:43:44.191 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.26 秒。
2025-04-27 21:43:44.192 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 结果计算失败: name 'determine_years' is not defined
2025-04-27 21:43:44.192 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:43:56.652 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:43:58.294 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:43:58.294 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:43:58.294 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:43:58.294 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:43:58.295 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:43:58.295 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:43:58.296 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:43:58.297 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:43:58.297 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:43:58.298 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:43:58.298 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:43:58.298 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:43:58.303 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:43:59.507 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:43:59.508 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:43:59.508 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:43:59.508 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:43:59.511 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 726 条 K 线数据。
2025-04-27 21:43:59.512 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 11:44:59.999000+00:00 的数据。
2025-04-27 21:43:59.513 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 11:44:59.999000+00:00)
2025-04-27 21:44:00.860 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 235 条获取到的 K 线存入数据库。
2025-04-27 21:44:00.860 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 21:44:00.862 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 21:44:00.862 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:44:01.529 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 21:44:01.536 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94471.0000, 当前价: 94293.9000
2025-04-27 21:44:02.139 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 21:44:02.143 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94842.1000, 当前价: 94771.3000
2025-04-27 21:44:03.454 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.59 秒。
2025-04-27 21:44:03.454 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:44:04.173 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:44:04.174 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:44:04.425 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:44:04.425 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.13 秒。
2025-04-27 21:44:04.426 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:44:04.427 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:44:04.428 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_214404_428.html
2025-04-27 21:44:05.322 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:44:05.323 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:44:50.063 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:44:51.738 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:44:51.738 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:44:51.739 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:44:51.739 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:44:51.739 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:44:51.739 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:44:51.741 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:44:51.741 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:44:51.741 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:44:51.742 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:44:51.742 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:44:51.743 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:44:51.747 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:44:53.225 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:44:53.226 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:44:53.226 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:44:53.226 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:44:53.228 | WARNING  | MainThread      | backtest.engine:_load_and_fetch_symbol_data:431 | [BTC/USDT:USDT] 数据库中无数据。
2025-04-27 21:44:53.228 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 21:44:53.229 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 5m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-27 00:00:00+00:00)
2025-04-27 21:44:54.078 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 865 条获取到的 K 线存入数据库。
2025-04-27 21:44:54.078 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 865 条。
2025-04-27 21:44:54.080 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:44:54.080 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:44:55.316 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:44:55.324 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:44:56.296 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.22 秒。
2025-04-27 21:44:56.296 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:44:56.996 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:44:56.997 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:44:57.247 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:44:57.247 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.51 秒。
2025-04-27 21:44:57.248 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:44:57.248 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:44:57.249 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_214457_249.html
2025-04-27 21:44:57.830 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:44:57.831 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:45:42.523 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:45:44.057 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:45:44.057 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:45:44.057 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN' 已初始化。
2025-04-27 21:45:44.058 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:45:44.058 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:45:44.059 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:45:44.060 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:45:44.060 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:45:44.061 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:45:44.061 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:45:44.061 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:45:44.065 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:45:45.585 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:45:45.586 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:45:45.586 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:45:45.586 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:45:45.590 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:45:45.591 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:45:45.591 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:45:45.593 | INFO     | MainThread      | strategies.mystrategy:_initialize_symbol_state:120 | [BTC/USDT:USDT] 已初始化状态。
2025-04-27 21:45:45.593 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (1 < 45)，跳过信号生成。
2025-04-27 21:45:45.594 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (2 < 45)，跳过信号生成。
2025-04-27 21:45:45.595 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (3 < 45)，跳过信号生成。
2025-04-27 21:45:45.596 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (4 < 45)，跳过信号生成。
2025-04-27 21:45:45.597 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (5 < 45)，跳过信号生成。
2025-04-27 21:45:45.597 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (6 < 45)，跳过信号生成。
2025-04-27 21:45:45.598 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (7 < 45)，跳过信号生成。
2025-04-27 21:45:45.599 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (8 < 45)，跳过信号生成。
2025-04-27 21:45:45.600 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (9 < 45)，跳过信号生成。
2025-04-27 21:45:45.601 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (10 < 45)，跳过信号生成。
2025-04-27 21:45:45.602 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (11 < 45)，跳过信号生成。
2025-04-27 21:45:45.603 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (12 < 45)，跳过信号生成。
2025-04-27 21:45:45.604 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (13 < 45)，跳过信号生成。
2025-04-27 21:45:45.605 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (14 < 45)，跳过信号生成。
2025-04-27 21:45:45.606 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (15 < 45)，跳过信号生成。
2025-04-27 21:45:45.607 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (16 < 45)，跳过信号生成。
2025-04-27 21:45:45.608 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (17 < 45)，跳过信号生成。
2025-04-27 21:45:45.608 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (18 < 45)，跳过信号生成。
2025-04-27 21:45:45.609 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (19 < 45)，跳过信号生成。
2025-04-27 21:45:45.610 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (20 < 45)，跳过信号生成。
2025-04-27 21:45:45.610 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (21 < 45)，跳过信号生成。
2025-04-27 21:45:45.611 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (22 < 45)，跳过信号生成。
2025-04-27 21:45:45.612 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (23 < 45)，跳过信号生成。
2025-04-27 21:45:45.613 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (24 < 45)，跳过信号生成。
2025-04-27 21:45:45.614 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (25 < 45)，跳过信号生成。
2025-04-27 21:45:45.614 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (26 < 45)，跳过信号生成。
2025-04-27 21:45:45.616 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (27 < 45)，跳过信号生成。
2025-04-27 21:45:45.617 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (28 < 45)，跳过信号生成。
2025-04-27 21:45:45.618 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (29 < 45)，跳过信号生成。
2025-04-27 21:45:45.619 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (30 < 45)，跳过信号生成。
2025-04-27 21:45:45.619 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (31 < 45)，跳过信号生成。
2025-04-27 21:45:45.621 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (32 < 45)，跳过信号生成。
2025-04-27 21:45:45.622 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (33 < 45)，跳过信号生成。
2025-04-27 21:45:45.623 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (34 < 45)，跳过信号生成。
2025-04-27 21:45:45.623 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (35 < 45)，跳过信号生成。
2025-04-27 21:45:45.624 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (36 < 45)，跳过信号生成。
2025-04-27 21:45:45.625 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (37 < 45)，跳过信号生成。
2025-04-27 21:45:45.626 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (38 < 45)，跳过信号生成。
2025-04-27 21:45:45.627 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (39 < 45)，跳过信号生成。
2025-04-27 21:45:45.628 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (40 < 45)，跳过信号生成。
2025-04-27 21:45:45.629 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (41 < 45)，跳过信号生成。
2025-04-27 21:45:45.629 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (42 < 45)，跳过信号生成。
2025-04-27 21:45:45.630 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (43 < 45)，跳过信号生成。
2025-04-27 21:45:45.631 | WARNING  | MainThread      | strategies.mystrategy:generate_signals:314 | [BTC/USDT:USDT] 数据不足 (44 < 45)，跳过信号生成。
2025-04-27 21:45:47.433 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 1.84 秒。
2025-04-27 21:45:47.434 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:45:47.436 | WARNING  | MainThread      | backtest.results:calculate_metrics:66 | 收益率序列为空或全为零 (可能回测期只有一个数据点或权益无变化)，部分指标无法计算。
2025-04-27 21:45:47.436 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:45:47.436 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:45:47.688 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:45:47.688 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 3.63 秒。
2025-04-27 21:45:47.689 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:45:47.689 | WARNING  | MainThread      | backtest.results:generate_report_html:182 | 收益率序列为空或全为零，无法生成 quantstats 报告。
2025-04-27 21:45:47.690 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:46:02.983 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:46:04.472 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:46:04.472 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:46:04.472 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:46:04.472 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:46:04.472 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:46:04.472 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:46:04.474 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:46:04.474 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:46:04.475 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:46:04.476 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:46:04.476 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:46:04.476 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:46:04.480 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:46:05.844 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:46:05.844 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:46:05.844 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:46:05.844 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:46:05.847 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:46:05.849 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:46:05.849 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:46:06.983 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:46:06.990 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:46:07.887 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.04 秒。
2025-04-27 21:46:07.888 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:46:08.497 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:46:08.498 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:46:08.753 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:46:08.753 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.28 秒。
2025-04-27 21:46:08.754 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:46:08.754 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:46:08.755 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_214608_755.html
2025-04-27 21:46:09.289 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:46:09.290 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:48:21.742 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:48:23.509 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:48:23.509 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:48:23.509 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:48:23.509 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:48:23.509 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:48:23.510 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:48:23.511 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:48:23.512 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:48:23.513 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:48:23.514 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:48:23.514 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:48:23.514 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:48:23.520 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:48:24.701 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:48:24.701 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:48:24.701 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:48:24.702 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:48:24.705 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:48:24.707 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:48:24.707 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:48:26.126 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:48:26.133 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:48:27.247 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.54 秒。
2025-04-27 21:48:27.248 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:48:27.989 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:48:27.990 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:48:28.240 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:48:28.240 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.73 秒。
2025-04-27 21:48:28.241 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:48:28.242 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:48:28.243 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_214828_243.html
2025-04-27 21:48:28.875 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:48:28.876 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:48:55.827 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:48:57.432 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:48:57.433 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:48:57.433 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:48:57.434 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:48:57.434 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:48:57.434 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:48:57.436 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:48:57.436 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:48:57.436 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:48:57.437 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:48:57.437 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:48:57.438 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:48:57.443 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:48:58.779 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:48:58.780 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:48:58.780 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:48:58.780 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:48:58.784 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:48:58.785 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:48:58.786 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:48:59.938 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:48:59.944 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:49:00.870 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.08 秒。
2025-04-27 21:49:00.870 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:49:01.556 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:49:01.556 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:49:01.808 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:49:01.808 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.37 秒。
2025-04-27 21:49:01.809 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:49:01.809 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:49:01.810 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_214901_810.html
2025-04-27 21:49:02.365 | ERROR    | MainThread      | backtest.results:generate_report_html:220 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:49:02.366 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:50:33.795 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:50:35.575 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:50:35.575 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:50:35.575 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:50:35.575 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:50:35.576 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:50:35.576 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:50:35.578 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:50:35.578 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:50:35.578 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:50:35.580 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:50:35.580 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:50:35.580 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:50:35.584 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:50:36.772 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:50:36.772 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:50:36.773 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:50:36.773 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:50:36.777 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:50:36.778 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:50:36.778 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:50:38.234 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:50:38.243 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:50:39.462 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.68 秒。
2025-04-27 21:50:39.462 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:50:40.315 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:50:40.315 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:50:40.566 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:50:40.566 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.99 秒。
2025-04-27 21:50:40.568 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:50:40.570 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:50:40.570 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_215040_570.html
2025-04-27 21:50:41.192 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:50:41.194 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:54:08.919 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:54:10.617 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:54:10.617 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:54:10.618 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:54:10.618 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:54:10.618 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:54:10.618 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:54:10.619 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:54:10.619 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:54:10.619 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:54:10.620 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:54:10.620 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:54:10.621 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:54:10.625 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:54:12.537 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:54:12.537 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:54:12.537 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:54:12.538 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:54:12.542 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:54:12.544 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:54:12.544 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:54:14.256 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:54:14.265 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:54:15.552 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.01 秒。
2025-04-27 21:54:15.553 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:54:16.250 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:54:16.250 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:54:16.503 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:54:16.503 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.88 秒。
2025-04-27 21:54:16.504 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:54:16.505 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:54:16.506 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_215416_506.html
2025-04-27 21:54:16.580 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: Invalid frequency: ME
2025-04-27 21:54:16.581 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:55:54.261 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:55:55.977 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:55:55.977 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:55:55.977 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:55:55.978 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:55:55.978 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:55:55.978 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:55:55.980 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:55:55.980 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:55:55.981 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:55:55.982 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:55:55.982 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:55:55.982 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:55:55.986 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:55:57.467 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:55:57.467 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:55:57.468 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:55:57.468 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:55:57.472 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:55:57.473 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:55:57.473 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:55:58.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:55:58.717 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:55:59.707 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.23 秒。
2025-04-27 21:55:59.707 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:56:00.359 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:56:00.359 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:56:00.612 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:56:00.612 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.63 秒。
2025-04-27 21:56:00.613 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:56:00.614 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:56:00.614 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_215600_614.html
2025-04-27 21:56:01.111 | ERROR    | MainThread      | backtest.results:generate_report_html:219 | 生成 QuantStats 回测报告时出错: numpy operations are not valid with resample. Use .resample(...).sum() instead
2025-04-27 21:56:01.112 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 21:57:54.710 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 21:57:56.380 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:57:56.380 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 21:57:56.380 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 21:57:56.380 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=5e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0005/0.0008
2025-04-27 21:57:56.381 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 21:57:56.381 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 21:57:56.383 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 21:57:56.383 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 21:57:56.384 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 21:57:56.385 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 21:57:56.385 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 21:57:56.385 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 21:57:56.390 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 21:57:57.562 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 21:57:57.562 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 21:57:57.562 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 21:57:57.563 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 21:57:57.567 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 21:57:57.569 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 21:57:57.569 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 21:57:58.846 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 21:57:58.853 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 21:57:59.882 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.31 秒。
2025-04-27 21:57:59.882 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 21:58:00.547 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 21:58:00.547 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 21:58:00.787 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 21:58:00.787 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.40 秒。
2025-04-27 21:58:00.788 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 21:58:00.789 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 21:58:00.790 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_215800_789.html
2025-04-27 21:58:01.763 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_215800_789.html
2025-04-27 21:58:01.764 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:02:11.141 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:02:12.860 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:02:12.860 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:02:12.860 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:02:12.860 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:02:12.860 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:02:12.861 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:02:12.862 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:02:12.863 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:02:12.863 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:02:12.864 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:02:12.864 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:02:12.864 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:02:12.869 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:02:18.398 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:02:18.398 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:02:18.399 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:02:18.400 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:02:18.404 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 22:02:18.405 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 22:02:18.405 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:02:19.015 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:02:19.022 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.04%). 原模式: short, 入场价: 93441.2000, 当前价: 93384.4000
2025-04-27 22:02:19.618 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:02:19.625 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:02:20.591 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.19 秒。
2025-04-27 22:02:20.592 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:02:21.224 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:02:21.224 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:02:21.477 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:02:21.477 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 8.61 秒。
2025-04-27 22:02:21.477 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:02:21.478 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:02:21.478 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220221_478.html
2025-04-27 22:02:22.472 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220221_478.html
2025-04-27 22:02:22.473 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:02:40.234 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:02:41.851 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:02:41.851 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:02:41.851 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:02:41.852 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:02:41.852 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:02:41.852 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:02:41.854 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:02:41.854 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:02:41.854 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:02:41.855 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:02:41.855 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:02:41.855 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:02:41.858 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:02:47.388 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:02:47.389 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:02:47.389 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:02:47.390 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:02:47.394 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 720 条 K 线数据。
2025-04-27 22:02:47.394 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:02:59.999000+00:00 的数据。
2025-04-27 22:02:47.395 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:02:59.999000+00:00)
2025-04-27 22:02:47.396 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:02:52.962 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:02:57.965 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:03:00.604 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 721 条获取到的 K 线存入数据库。
2025-04-27 22:03:00.605 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:03:00.606 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:03:00.606 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:03:01.642 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:03:01.646 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.04%). 原模式: short, 入场价: 93358.7000, 当前价: 93429.5000
2025-04-27 22:03:02.545 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:03:02.549 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:03:03.182 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:03:03.185 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.04%). 原模式: short, 入场价: 94842.1000, 当前价: 94771.3000
2025-04-27 22:03:03.592 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:03:03.597 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.04%). 原模式: short, 入场价: 94619.7000, 当前价: 94544.1000
2025-04-27 22:03:04.100 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:03:04.104 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.04%). 原模式: short, 入场价: 94223.7000, 当前价: 94308.7000
2025-04-27 22:03:04.413 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.81 秒。
2025-04-27 22:03:04.413 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:03:05.094 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:03:05.094 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:03:05.336 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:03:05.336 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 23.48 秒。
2025-04-27 22:03:05.337 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:03:05.337 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:03:05.339 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220305_339.html
2025-04-27 22:03:06.457 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220305_339.html
2025-04-27 22:03:06.458 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:03:23.886 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:03:25.505 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:03:25.505 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:03:25.505 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:03:25.505 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:03:25.505 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:03:25.506 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:03:25.508 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:03:25.508 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:03:25.509 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:03:25.510 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:03:25.511 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:03:25.511 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:03:25.517 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:03:26.724 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:03:26.724 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:03:26.724 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:03:26.724 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:03:26.728 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 719 条 K 线数据。
2025-04-27 22:03:26.729 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:05:59.999000+00:00 的数据。
2025-04-27 22:03:26.729 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:05:59.999000+00:00)
2025-04-27 22:03:28.112 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 722 条获取到的 K 线存入数据库。
2025-04-27 22:03:28.114 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:03:28.115 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:03:28.115 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:03:29.171 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:03:29.178 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93358.7000, 当前价: 93433.5000
2025-04-27 22:03:30.154 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:03:30.159 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:03:30.733 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:03:30.762 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:03:31.150 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:03:31.157 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.10%). 原模式: short, 入场价: 94619.7000, 当前价: 94517.7000
2025-04-27 22:03:31.665 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:03:31.674 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.10%). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:03:31.988 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.87 秒。
2025-04-27 22:03:31.988 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:03:32.660 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:03:32.660 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:03:32.927 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:03:32.927 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.42 秒。
2025-04-27 22:03:32.928 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:03:32.929 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:03:32.930 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220332_930.html
2025-04-27 22:03:34.051 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220332_930.html
2025-04-27 22:03:34.052 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:04:01.081 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:04:02.706 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:04:02.707 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:04:02.707 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:04:02.707 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:04:02.707 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:04:02.708 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:04:02.709 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:04:02.710 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:04:02.710 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:04:02.712 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:04:02.712 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:04:02.713 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:04:02.716 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:04:04.062 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:04:04.063 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:04:04.063 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:04:04.063 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:04:04.067 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 719 条 K 线数据。
2025-04-27 22:04:04.068 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:05:59.999000+00:00 的数据。
2025-04-27 22:04:04.068 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:05:59.999000+00:00)
2025-04-27 22:04:05.366 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 722 条获取到的 K 线存入数据库。
2025-04-27 22:04:05.367 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:04:05.368 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:04:05.369 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:04:06.348 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:04:06.355 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93358.7000, 当前价: 93433.5000
2025-04-27 22:04:07.222 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:04:07.225 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:04:07.810 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:04:07.839 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:04:08.211 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:04:08.223 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.15%). 原模式: short, 入场价: 94619.7000, 当前价: 94340.9000
2025-04-27 22:04:08.728 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:04:08.737 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:04:09.046 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.68 秒。
2025-04-27 22:04:09.046 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:04:09.707 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:04:09.707 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:04:09.961 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:04:09.961 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.25 秒。
2025-04-27 22:04:09.962 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:04:09.963 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:04:09.963 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220409_963.html
2025-04-27 22:04:11.022 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220409_963.html
2025-04-27 22:04:11.023 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:04:49.880 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:04:51.581 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:04:51.582 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:04:51.582 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:04:51.582 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:04:51.582 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:04:51.583 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:04:51.584 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:04:51.584 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:04:51.585 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:04:51.586 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:04:51.586 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:04:51.586 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:04:51.590 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:04:53.136 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:04:53.136 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:04:53.137 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:04:53.137 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:04:53.141 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 719 条 K 线数据。
2025-04-27 22:04:53.141 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:05:59.999000+00:00 的数据。
2025-04-27 22:04:53.142 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:05:59.999000+00:00)
2025-04-27 22:04:54.430 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 722 条获取到的 K 线存入数据库。
2025-04-27 22:04:54.431 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:04:54.433 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:04:54.433 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:04:55.490 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:04:55.497 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93358.7000, 当前价: 93433.5000
2025-04-27 22:04:56.447 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:04:56.451 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.04%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:04:57.054 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:04:57.076 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.04%). 原模式: short, 入场价: 94842.1000, 当前价: 94896.3000
2025-04-27 22:04:57.467 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:04:57.474 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.10%). 原模式: short, 入场价: 94619.7000, 当前价: 94517.7000
2025-04-27 22:04:57.987 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:04:57.999 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.10%). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:04:58.354 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.92 秒。
2025-04-27 22:04:58.354 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:04:59.035 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:04:59.035 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:04:59.271 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:04:59.271 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.69 秒。
2025-04-27 22:04:59.272 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:04:59.272 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:04:59.273 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220459_273.html
2025-04-27 22:05:00.348 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220459_273.html
2025-04-27 22:05:00.349 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:06:29.835 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:06:31.464 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:06:31.464 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:06:31.464 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:06:31.465 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:06:31.465 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:06:31.465 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:06:31.467 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:06:31.467 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:06:31.468 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:06:31.469 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:06:31.469 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:06:31.470 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:06:31.473 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:06:32.948 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:06:32.948 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:06:32.948 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:06:32.949 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:06:32.952 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 718 条 K 线数据。
2025-04-27 22:06:32.953 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:08:59.999000+00:00 的数据。
2025-04-27 22:06:32.953 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:08:59.999000+00:00)
2025-04-27 22:06:34.507 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 723 条获取到的 K 线存入数据库。
2025-04-27 22:06:34.509 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:06:34.510 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:06:34.511 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:06:35.567 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:06:35.573 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93358.7000, 当前价: 93433.5000
2025-04-27 22:06:36.473 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:06:36.477 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:06:37.083 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:06:37.111 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:06:37.489 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:06:37.504 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 94619.7000, 当前价: 94340.9000
2025-04-27 22:06:38.036 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:06:38.046 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:06:38.370 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.86 秒。
2025-04-27 22:06:38.371 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:06:39.064 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:06:39.064 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:06:39.317 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:06:39.317 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.85 秒。
2025-04-27 22:06:39.318 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:06:39.320 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:06:39.321 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220639_321.html
2025-04-27 22:06:40.418 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220639_321.html
2025-04-27 22:06:40.419 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:07:20.384 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:07:22.139 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:07:22.139 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:07:22.139 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:07:22.139 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:07:22.140 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:07:22.140 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:07:22.141 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:07:22.142 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:07:22.142 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:07:22.143 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:07:22.144 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:07:22.144 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:07:22.149 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:07:23.485 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:07:23.485 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:07:23.485 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:07:23.486 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:07:23.489 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 718 条 K 线数据。
2025-04-27 22:07:23.490 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-25 12:08:59.999000+00:00 的数据。
2025-04-27 22:07:23.490 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-25 12:08:59.999000+00:00)
2025-04-27 22:07:24.904 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 723 条获取到的 K 线存入数据库。
2025-04-27 22:07:24.905 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1441 条。
2025-04-27 22:07:24.907 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1441 行数据，覆盖 1441 个时间点。
2025-04-27 22:07:24.907 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:07:25.904 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:07:25.910 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93358.7000, 当前价: 93433.5000
2025-04-27 22:07:26.794 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:07:26.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:07:27.367 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:07:27.396 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:07:27.781 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:07:27.793 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 死叉 (平多仓). 原模式: short, 入场价: 94619.7000, 当前价: 94340.9000
2025-04-27 22:07:28.284 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:07:28.294 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:07:28.607 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 3.70 秒。
2025-04-27 22:07:28.607 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:07:29.290 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:07:29.290 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:07:29.543 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:07:29.543 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.40 秒。
2025-04-27 22:07:29.544 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:07:29.544 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:07:29.545 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220729_545.html
2025-04-27 22:07:30.610 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220729_545.html
2025-04-27 22:07:30.611 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:07:57.014 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:07:58.587 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:07:58.587 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:07:58.587 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:07:58.588 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:07:58.588 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:07:58.588 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:07:58.589 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:07:58.589 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:07:58.590 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:07:58.591 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:07:58.591 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:07:58.591 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:07:58.595 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:07:59.750 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:07:59.750 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:07:59.750 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:07:59.750 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:07:59.753 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 585 条 K 线数据。
2025-04-27 22:07:59.754 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-24 00:00:00+00:00 到 2025-04-26 14:15:59.999000+00:00 的数据。
2025-04-27 22:07:59.755 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 1m K线数据 (2025-04-24 00:00:00+00:00 to 2025-04-26 14:15:59.999000+00:00)
2025-04-27 22:08:04.024 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3736 条获取到的 K 线存入数据库。
2025-04-27 22:08:04.026 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 4321 条。
2025-04-27 22:08:04.027 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 4321 行数据，覆盖 4321 个时间点。
2025-04-27 22:08:04.027 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:08:05.561 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 92416.5000, 模式: short
2025-04-27 22:08:05.592 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 死叉 (平多仓). 原模式: short, 入场价: 92416.5000, 当前价: 92378.5000
2025-04-27 22:08:06.133 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 92787.7000, 模式: short
2025-04-27 22:08:06.144 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 92787.7000, 当前价: 92865.4000
2025-04-27 22:08:06.163 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92588.8000, 模式: short
2025-04-27 22:08:06.167 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 92588.8000, 当前价: 92672.6000
2025-04-27 22:08:09.382 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93601.3000, 模式: short
2025-04-27 22:08:09.412 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93601.3000, 当前价: 93540.7000
2025-04-27 22:08:11.474 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94802.3000, 模式: short
2025-04-27 22:08:11.491 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94802.3000, 当前价: 94706.1000
2025-04-27 22:08:11.796 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94868.9000, 模式: short
2025-04-27 22:08:11.812 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94868.9000, 当前价: 94818.4000
2025-04-27 22:08:11.932 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94575.9000, 模式: short
2025-04-27 22:08:11.940 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94575.9000, 当前价: 94662.2000
2025-04-27 22:08:12.084 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94722.6000, 模式: short
2025-04-27 22:08:12.088 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94722.6000, 当前价: 94842.1000
2025-04-27 22:08:12.983 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94583.6000, 模式: short
2025-04-27 22:08:13.024 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94583.6000, 当前价: 94652.2000
2025-04-27 22:08:13.092 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94608.4000, 模式: short
2025-04-27 22:08:13.107 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94608.4000, 当前价: 94557.0000
2025-04-27 22:08:13.265 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94737.0000, 模式: short
2025-04-27 22:08:13.296 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 死叉 (平多仓). 原模式: short, 入场价: 94737.0000, 当前价: 94701.9000
2025-04-27 22:08:14.009 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94100.2000, 模式: short
2025-04-27 22:08:14.033 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94100.2000, 当前价: 94158.3000
2025-04-27 22:08:14.865 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94292.1000, 模式: short
2025-04-27 22:08:14.878 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 94292.1000, 当前价: 94163.9000
2025-04-27 22:08:15.152 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94303.8000, 模式: short
2025-04-27 22:08:15.190 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 死叉 (平多仓). 原模式: short, 入场价: 94303.8000, 当前价: 94260.5000
2025-04-27 22:08:15.590 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94111.6000, 模式: short
2025-04-27 22:08:15.606 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94111.6000, 当前价: 94036.3000
2025-04-27 22:08:16.117 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 12.09 秒。
2025-04-27 22:08:16.117 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:08:16.787 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:08:16.787 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:08:17.045 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:08:17.045 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 18.46 秒。
2025-04-27 22:08:17.046 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:08:17.047 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:08:17.047 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220817_047.html
2025-04-27 22:08:18.224 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220817_047.html
2025-04-27 22:08:18.225 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:09:09.072 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:09:10.754 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:09:10.754 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:09:10.754 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:09:10.754 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:09:10.755 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:09:10.755 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:09:10.757 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:09:10.757 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:09:10.757 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:09:10.758 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:09:10.759 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:09:10.759 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:09:10.763 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:09:12.207 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:09:12.207 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:09:12.208 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:09:12.208 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:09:12.212 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 22:09:12.213 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 22:09:12.213 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:09:12.813 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:09:12.820 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.05%). 原模式: short, 入场价: 93441.2000, 当前价: 93384.4000
2025-04-27 22:09:13.412 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:09:13.419 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:09:14.361 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.15 秒。
2025-04-27 22:09:14.361 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:09:15.044 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:09:15.044 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:09:15.297 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:09:15.297 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.54 秒。
2025-04-27 22:09:15.298 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:09:15.298 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:09:15.299 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220915_299.html
2025-04-27 22:09:16.304 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220915_299.html
2025-04-27 22:09:16.305 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:09:52.393 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:09:53.937 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:09:53.937 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:09:53.937 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:09:53.937 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:09:53.937 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:09:53.938 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:09:53.939 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:09:53.939 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:09:53.940 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:09:53.942 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:09:53.942 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:09:53.942 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:09:53.945 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:09:55.193 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:09:55.194 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:09:55.194 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:09:55.194 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:09:55.198 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 22:09:55.199 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 22:09:55.199 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:09:55.774 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:09:55.789 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93441.2000, 当前价: 93530.0000
2025-04-27 22:09:56.368 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:09:56.375 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:09:57.292 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.09 秒。
2025-04-27 22:09:57.292 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:09:57.932 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:09:57.932 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:09:58.185 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:09:58.185 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.25 秒。
2025-04-27 22:09:58.186 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:09:58.187 | INFO     | MainThread      | backtest.results:generate_report_html:193 | 将使用收益率生成报告，交易细节图表可能不完整。
2025-04-27 22:09:58.188 | INFO     | MainThread      | backtest.results:generate_report_html:207 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220958_188.html
2025-04-27 22:09:59.118 | INFO     | MainThread      | backtest.results:generate_report_html:216 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_220958_188.html
2025-04-27 22:09:59.119 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:15:19.519 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:15:21.175 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:15:21.175 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:15:21.175 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:15:21.175 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:15:21.176 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:15:21.176 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:15:21.178 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:15:21.178 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:15:21.179 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:15:21.180 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:15:21.180 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:15:21.180 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:15:21.184 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:15:22.589 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:15:22.589 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:15:22.589 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:15:22.590 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:15:22.593 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 22:15:22.594 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 865 行数据，覆盖 865 个时间点。
2025-04-27 22:15:22.595 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:15:23.219 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:15:23.234 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93441.2000, 当前价: 93530.0000
2025-04-27 22:15:23.815 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:15:23.821 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:15:24.755 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.16 秒。
2025-04-27 22:15:24.755 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:15:25.390 | ERROR    | MainThread      | backtest.engine:_calculate_results:1021 | 计算结果时出错: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:15:25.390 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:15:25.391 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:15:25.642 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:15:25.642 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 4.46 秒。
2025-04-27 22:15:25.643 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 结果计算失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:15:25.643 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:17:37.631 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:17:39.284 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:17:39.284 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:17:39.285 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:17:39.285 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:17:39.285 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:17:39.285 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:17:39.287 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:17:39.287 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:17:39.287 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:17:39.288 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:17:39.288 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:17:39.289 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:17:39.295 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:17:40.550 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:17:40.551 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:17:40.551 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:17:40.551 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:17:40.554 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 865 条 K 线数据。
2025-04-27 22:17:40.555 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-20 00:00:00+00:00 到 2025-04-23 23:59:59.999000+00:00 的数据。
2025-04-27 22:17:40.555 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 5m K线数据 (2025-04-20 00:00:00+00:00 to 2025-04-23 23:59:59.999000+00:00)
2025-04-27 22:17:42.882 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 1152 条获取到的 K 线存入数据库。
2025-04-27 22:17:42.884 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 2017 条。
2025-04-27 22:17:42.885 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 2017 行数据，覆盖 2017 个时间点。
2025-04-27 22:17:42.886 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:17:43.313 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84504.7000, 模式: short
2025-04-27 22:17:43.331 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84504.7000, 当前价: 84577.6000
2025-04-27 22:17:43.535 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84982.8000, 模式: short
2025-04-27 22:17:43.542 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84982.8000, 当前价: 85069.9000
2025-04-27 22:17:44.275 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 86989.1000, 模式: short
2025-04-27 22:17:44.306 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 86989.1000, 当前价: 87113.4000
2025-04-27 22:17:45.057 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 91477.0000, 模式: short
2025-04-27 22:17:45.067 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 91477.0000, 当前价: 91289.3000
2025-04-27 22:17:45.620 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93365.6000, 模式: short
2025-04-27 22:17:45.624 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 93365.6000, 当前价: 93887.1000
2025-04-27 22:17:45.890 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93487.1000, 模式: short
2025-04-27 22:17:45.899 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93487.1000, 当前价: 93427.1000
2025-04-27 22:17:46.711 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:17:46.725 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93441.2000, 当前价: 93530.0000
2025-04-27 22:17:47.381 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:17:47.388 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:17:48.490 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 5.60 秒。
2025-04-27 22:17:48.490 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:17:48.494 | INFO     | MainThread      | backtest.results:calculate_metrics:111 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:17:49.200 | WARNING  | MainThread      | backtest.results:calculate_metrics:117 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:17:49.203 | WARNING  | MainThread      | backtest.results:calculate_metrics:123 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:17:49.204 | WARNING  | MainThread      | backtest.results:calculate_metrics:131 | 计算夏普比率失败: name 'np' is not defined
2025-04-27 22:17:49.206 | WARNING  | MainThread      | backtest.results:calculate_metrics:140 | 计算索提诺比率失败: name 'np' is not defined
2025-04-27 22:17:49.206 | WARNING  | MainThread      | backtest.results:calculate_metrics:164 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:17:49.207 | ERROR    | MainThread      | backtest.engine:_calculate_results:1021 | 计算结果时出错: name 'np' is not defined
2025-04-27 22:17:49.208 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:17:49.208 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:17:49.460 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:17:49.460 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 10.17 秒。
2025-04-27 22:17:49.460 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 结果计算失败: name 'np' is not defined
2025-04-27 22:17:49.462 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:18:20.755 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:18:22.475 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:18:22.476 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:18:22.476 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:18:22.476 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:18:22.476 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:18:22.477 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:18:22.478 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:18:22.478 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:18:22.479 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:18:22.482 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:18:22.482 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:18:22.482 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:18:22.486 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:18:23.663 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:18:23.664 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:18:23.664 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:18:23.664 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:18:23.670 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 2017 条 K 线数据。
2025-04-27 22:18:23.670 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 2017 行数据，覆盖 2017 个时间点。
2025-04-27 22:18:23.671 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:18:24.113 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84504.7000, 模式: short
2025-04-27 22:18:24.130 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84504.7000, 当前价: 84577.6000
2025-04-27 22:18:24.329 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84982.8000, 模式: short
2025-04-27 22:18:24.336 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84982.8000, 当前价: 85069.9000
2025-04-27 22:18:25.085 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 86989.1000, 模式: short
2025-04-27 22:18:25.117 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 86989.1000, 当前价: 87113.4000
2025-04-27 22:18:25.872 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 91477.0000, 模式: short
2025-04-27 22:18:25.881 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 91477.0000, 当前价: 91289.3000
2025-04-27 22:18:26.419 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93365.6000, 模式: short
2025-04-27 22:18:26.423 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 93365.6000, 当前价: 93887.1000
2025-04-27 22:18:26.755 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93487.1000, 模式: short
2025-04-27 22:18:26.765 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93487.1000, 当前价: 93427.1000
2025-04-27 22:18:27.596 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93441.2000, 模式: short
2025-04-27 22:18:27.611 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 93441.2000, 当前价: 93530.0000
2025-04-27 22:18:28.273 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:18:28.280 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:18:29.317 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 5.65 秒。
2025-04-27 22:18:29.317 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:18:29.322 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:18:30.036 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:18:30.037 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:18:30.041 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:18:30.042 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:18:30.042 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:18:30.287 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:18:30.287 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 7.81 秒。
2025-04-27 22:18:30.288 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:18:30.288 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:18:30.289 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221830_289.html
2025-04-27 22:18:31.425 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221830_289.html
2025-04-27 22:18:31.426 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:19:15.849 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:19:17.512 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:19:17.512 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:19:17.512 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:19:17.513 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:19:17.513 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:19:17.513 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:19:17.515 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:19:17.515 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:19:17.515 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:19:17.516 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:19:17.516 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:19:17.516 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:19:17.520 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:19:18.966 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:19:18.966 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:19:18.966 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:19:18.967 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:19:18.971 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 577 条 K 线数据。
2025-04-27 22:19:18.972 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 577 行数据，覆盖 577 个时间点。
2025-04-27 22:19:18.972 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:19:19.434 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94779.4000, 模式: short
2025-04-27 22:19:19.441 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94779.4000, 当前价: 94495.3000
2025-04-27 22:19:20.418 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 1.45 秒。
2025-04-27 22:19:20.419 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:19:20.422 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:19:21.069 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:19:21.070 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:19:21.073 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:19:21.075 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:19:21.075 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:19:21.327 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:19:21.327 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 3.81 秒。
2025-04-27 22:19:21.328 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:19:21.328 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:19:21.329 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221921_329.html
2025-04-27 22:19:22.444 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221921_329.html
2025-04-27 22:19:22.445 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:19:45.788 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:19:47.469 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:19:47.469 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:19:47.469 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:19:47.469 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:19:47.469 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:19:47.469 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:19:47.471 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:19:47.471 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:19:47.472 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:19:47.473 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:19:47.473 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:19:47.473 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:19:47.478 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:19:48.962 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:19:48.962 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:19:48.962 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:19:48.962 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:19:48.965 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 714 条 K 线数据。
2025-04-27 22:19:48.966 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:20:59.999000+00:00 的数据。
2025-04-27 22:19:48.966 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:20:59.999000+00:00)
2025-04-27 22:19:50.508 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 247 条获取到的 K 线存入数据库。
2025-04-27 22:19:50.509 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:19:50.510 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:19:50.510 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:19:51.165 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:19:51.168 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:19:51.786 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:19:51.818 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:19:52.223 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:19:52.235 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.20%). 原模式: short, 入场价: 94619.7000, 当前价: 94340.9000
2025-04-27 22:19:52.777 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:19:52.786 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:19:53.130 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.62 秒。
2025-04-27 22:19:53.131 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:19:53.135 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:19:53.835 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:19:53.837 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:19:53.840 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:19:53.842 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:19:53.842 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:19:54.095 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:19:54.095 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.62 秒。
2025-04-27 22:19:54.096 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:19:54.096 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:19:54.097 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221954_097.html
2025-04-27 22:19:55.261 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_221954_097.html
2025-04-27 22:19:55.262 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:23:19.983 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:23:21.613 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:23:21.613 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:23:21.613 | INFO     | MainThread      | strategies.mystrategy:__init__:52 | 策略 'HighFreq_50pt_Strategy' 已初始化，目标点数: 50 点，止损: 0.10%
2025-04-27 22:23:21.613 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:23:21.613 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:23:21.614 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:23:21.615 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:23:21.615 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:23:21.616 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:23:21.616 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:23:21.617 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:23:21.621 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:23:23.149 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:23:23.150 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:23:23.150 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:23:23.150 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:23:23.154 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 713 条 K 线数据。
2025-04-27 22:23:23.154 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:23:59.999000+00:00 的数据。
2025-04-27 22:23:23.155 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:23:59.999000+00:00)
2025-04-27 22:23:24.442 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 248 条获取到的 K 线存入数据库。
2025-04-27 22:23:24.443 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:23:24.444 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:23:24.444 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:23:26.700 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.26 秒。
2025-04-27 22:23:26.700 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:23:26.704 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:23:27.339 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:23:27.340 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:23:27.344 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:23:27.345 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:23:27.346 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:23:27.598 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:23:27.598 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.98 秒。
2025-04-27 22:23:27.599 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:23:27.600 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:23:27.600 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222327_600.html
2025-04-27 22:23:28.685 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222327_600.html
2025-04-27 22:23:28.687 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:24:34.931 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:24:36.634 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:24:36.634 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:24:36.634 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:24:36.634 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:24:36.636 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:24:36.636 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:24:36.637 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:24:36.638 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:24:36.638 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:24:36.638 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:24:36.643 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:24:38.074 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:24:38.074 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:24:38.074 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:24:38.074 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:24:38.078 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 712 条 K 线数据。
2025-04-27 22:24:38.079 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:26:59.999000+00:00 的数据。
2025-04-27 22:24:38.079 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:26:59.999000+00:00)
2025-04-27 22:24:39.517 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 249 条获取到的 K 线存入数据库。
2025-04-27 22:24:39.519 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:24:39.520 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:24:39.520 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:24:41.993 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.47 秒。
2025-04-27 22:24:41.993 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:24:41.998 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:24:42.662 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:24:42.664 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:24:42.667 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:24:42.668 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:24:42.668 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:24:42.921 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:24:42.921 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.28 秒。
2025-04-27 22:24:42.922 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:24:42.923 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:24:42.923 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222442_923.html
2025-04-27 22:24:44.010 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222442_923.html
2025-04-27 22:24:44.011 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:25:29.580 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:25:31.111 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:25:31.111 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:25:31.111 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:25:31.111 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:25:31.113 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:25:31.113 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:25:31.113 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:25:31.114 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:25:31.114 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:25:31.115 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:25:31.118 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:25:32.337 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:25:32.338 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:25:32.338 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:25:32.338 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:25:32.342 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 712 条 K 线数据。
2025-04-27 22:25:32.342 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:26:59.999000+00:00 的数据。
2025-04-27 22:25:32.343 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:26:59.999000+00:00)
2025-04-27 22:25:33.692 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 249 条获取到的 K 线存入数据库。
2025-04-27 22:25:33.693 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:25:33.694 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:25:33.695 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:25:35.880 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.18 秒。
2025-04-27 22:25:35.880 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:25:35.883 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:25:36.499 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:25:36.500 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:25:36.503 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:25:36.505 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:25:36.505 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:25:36.756 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:25:36.756 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.64 秒。
2025-04-27 22:25:36.758 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:25:36.758 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:25:36.759 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222536_759.html
2025-04-27 22:25:37.788 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222536_759.html
2025-04-27 22:25:37.790 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:26:58.792 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:27:00.321 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:27:00.321 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:27:00.321 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:27:00.321 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:27:00.323 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:27:00.323 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:27:00.323 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:27:00.324 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:27:00.324 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:27:00.325 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:27:00.328 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:27:01.692 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:27:01.692 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:27:01.692 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:27:01.692 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:27:01.696 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 711 条 K 线数据。
2025-04-27 22:27:01.696 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:29:59.999000+00:00 的数据。
2025-04-27 22:27:01.697 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:29:59.999000+00:00)
2025-04-27 22:27:03.030 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 250 条获取到的 K 线存入数据库。
2025-04-27 22:27:03.031 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:27:03.033 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:27:03.033 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:27:04.825 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 1.79 秒。
2025-04-27 22:27:04.825 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:27:04.830 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:27:05.464 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:27:05.465 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:27:05.468 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:27:05.469 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:27:05.469 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:27:05.723 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:27:05.723 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.40 秒。
2025-04-27 22:27:05.724 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:27:05.725 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:27:05.725 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222705_725.html
2025-04-27 22:27:06.790 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_222705_725.html
2025-04-27 22:27:06.791 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:31:43.876 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:31:45.407 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:31:45.407 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:31:45.407 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:31:45.407 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:31:45.407 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:31:45.407 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:31:45.409 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:31:45.410 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:31:45.410 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:31:45.411 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:31:45.411 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:31:45.412 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:31:45.416 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:31:46.929 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:31:46.929 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:31:46.930 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:31:46.930 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:31:46.933 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 710 条 K 线数据。
2025-04-27 22:31:46.933 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:32:59.999000+00:00 的数据。
2025-04-27 22:31:46.935 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:32:59.999000+00:00)
2025-04-27 22:31:48.242 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 251 条获取到的 K 线存入数据库。
2025-04-27 22:31:48.243 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:31:48.245 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:31:48.245 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:31:48.875 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:31:48.880 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:31:49.424 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:31:49.453 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:31:49.818 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:31:49.831 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 死叉 (平多仓). 原模式: short, 入场价: 94619.7000, 当前价: 94340.9000
2025-04-27 22:31:50.328 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94223.7000, 模式: short
2025-04-27 22:31:50.338 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94223.7000, 当前价: 94334.7000
2025-04-27 22:31:50.636 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.39 秒。
2025-04-27 22:31:50.636 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:31:50.639 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:31:51.229 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:31:51.230 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:31:51.233 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:31:51.234 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:31:51.234 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:31:51.486 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:31:51.486 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.08 秒。
2025-04-27 22:31:51.487 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:31:51.487 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:31:51.488 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223151_488.html
2025-04-27 22:31:52.526 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223151_488.html
2025-04-27 22:31:52.527 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:33:00.072 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:33:01.756 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:33:01.756 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:33:01.756 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:33:01.756 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.3, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:33:01.756 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:33:01.756 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:33:01.758 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:33:01.758 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:33:01.759 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:33:01.760 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:33:01.760 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:33:01.760 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:33:01.764 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:33:03.024 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:33:03.024 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:33:03.025 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:33:03.025 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:33:03.030 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 709 条 K 线数据。
2025-04-27 22:33:03.030 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:35:59.999000+00:00 的数据。
2025-04-27 22:33:03.031 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:35:59.999000+00:00)
2025-04-27 22:33:04.309 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 252 条获取到的 K 线存入数据库。
2025-04-27 22:33:04.311 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:33:04.312 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:33:04.312 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:33:04.934 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:33:04.939 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94471.0000, 当前价: 94540.2000
2025-04-27 22:33:05.508 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:33:05.540 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94842.1000, 当前价: 94915.1000
2025-04-27 22:33:05.918 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:33:06.662 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 94619.7000, 当前价: 94678.4000
2025-04-27 22:33:06.736 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.42 秒。
2025-04-27 22:33:06.736 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:33:06.739 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:33:07.391 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:33:07.392 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:33:07.395 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:33:07.397 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:33:07.397 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:33:07.651 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:33:07.651 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.89 秒。
2025-04-27 22:33:07.652 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:33:07.654 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:33:07.654 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223307_654.html
2025-04-27 22:33:08.748 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223307_654.html
2025-04-27 22:33:08.749 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:34:51.387 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:34:53.113 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:34:53.114 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:34:53.114 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:34:53.114 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.15, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:34:53.114 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:34:53.114 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:34:53.116 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:34:53.116 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:34:53.117 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:34:53.118 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:34:53.118 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:34:53.118 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:34:53.122 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:34:54.326 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:34:54.326 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:34:54.326 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:34:54.326 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:34:54.330 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 709 条 K 线数据。
2025-04-27 22:34:54.330 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:35:59.999000+00:00 的数据。
2025-04-27 22:34:54.330 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:35:59.999000+00:00)
2025-04-27 22:34:55.730 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 252 条获取到的 K 线存入数据库。
2025-04-27 22:34:55.732 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:34:55.733 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:34:55.733 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:34:56.338 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94471.0000, 模式: short
2025-04-27 22:34:56.355 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94471.0000, 当前价: 94551.4000
2025-04-27 22:34:56.902 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:34:56.932 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:34:57.301 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94619.7000, 模式: short
2025-04-27 22:34:58.042 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94619.7000, 当前价: 94720.1000
2025-04-27 22:34:58.118 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.39 秒。
2025-04-27 22:34:58.119 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:34:58.123 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:34:58.751 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:34:58.753 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:34:58.755 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:34:58.757 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:34:58.757 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:34:59.009 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:34:59.009 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.89 秒。
2025-04-27 22:34:59.009 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:34:59.011 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:34:59.012 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223459_012.html
2025-04-27 22:35:00.133 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223459_012.html
2025-04-27 22:35:00.134 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:37:16.790 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:37:18.469 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:37:18.469 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:37:18.470 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:37:18.470 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.15, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:37:18.470 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:37:18.470 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:37:18.472 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:37:18.473 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:37:18.473 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:37:18.474 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:37:18.474 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:37:18.475 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:37:18.479 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:37:19.876 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:37:19.876 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:37:19.876 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:37:19.877 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:37:19.880 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 708 条 K 线数据。
2025-04-27 22:37:19.880 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:38:59.999000+00:00 的数据。
2025-04-27 22:37:19.881 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:38:59.999000+00:00)
2025-04-27 22:37:21.271 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 253 条获取到的 K 线存入数据库。
2025-04-27 22:37:21.272 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:37:21.274 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:37:21.274 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:37:21.706 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93668.4000, 模式: short
2025-04-27 22:37:21.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93668.4000, 当前价: 93806.4000
2025-04-27 22:37:22.499 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:37:22.530 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:37:22.855 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94638.9000, 模式: short
2025-04-27 22:37:22.864 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94638.9000, 当前价: 94544.7000
2025-04-27 22:37:23.014 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94168.5000, 模式: short
2025-04-27 22:37:23.038 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94168.5000, 当前价: 94079.5000
2025-04-27 22:37:23.681 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.41 秒。
2025-04-27 22:37:23.681 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:37:23.685 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:37:24.292 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:37:24.294 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:37:24.297 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:37:24.298 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:37:24.298 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:37:24.550 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:37:24.550 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.08 秒。
2025-04-27 22:37:24.551 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:37:24.552 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:37:24.552 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223724_552.html
2025-04-27 22:37:25.626 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223724_552.html
2025-04-27 22:37:25.627 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:37:49.117 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:37:50.838 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:37:50.839 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:37:50.839 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:37:50.839 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.15, 中/长线EMA分离度=0.0003/0.0005
2025-04-27 22:37:50.840 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:37:50.840 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:37:50.841 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:37:50.842 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:37:50.842 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:37:50.843 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:37:50.843 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:37:50.844 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:37:50.848 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:37:52.028 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:37:52.030 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:37:52.030 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:37:52.030 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:37:52.033 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 708 条 K 线数据。
2025-04-27 22:37:52.034 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:38:59.999000+00:00 的数据。
2025-04-27 22:37:52.034 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:38:59.999000+00:00)
2025-04-27 22:37:53.301 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 253 条获取到的 K 线存入数据库。
2025-04-27 22:37:53.302 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:37:53.303 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:37:53.303 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:37:53.578 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:37:53.598 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:37:53.671 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93530.0000, 模式: short
2025-04-27 22:37:53.678 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 93530.0000, 当前价: 93673.2000
2025-04-27 22:37:54.532 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:37:54.536 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:37:54.624 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:37:54.656 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:37:54.962 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:37:54.974 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 金叉 (平空仓). 原模式: short, 入场价: 94611.0000, 当前价: 94642.3000
2025-04-27 22:37:55.574 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:562 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:37:55.783 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:399 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:37:55.890 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.59 秒。
2025-04-27 22:37:55.890 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:37:55.893 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:37:56.594 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:37:56.596 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:37:56.600 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:37:56.602 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:37:56.602 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:37:56.855 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:37:56.855 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.01 秒。
2025-04-27 22:37:56.856 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:37:56.857 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:37:56.857 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223756_857.html
2025-04-27 22:37:57.993 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223756_857.html
2025-04-27 22:37:57.994 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:38:40.173 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:38:41.858 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:38:41.858 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:38:41.858 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:38:41.858 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=2e-05, 交叉成交量确认因子=1.15, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:38:41.858 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:38:41.858 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:38:41.860 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:38:41.860 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:38:41.861 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:38:41.862 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:38:41.862 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:38:41.862 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:38:41.866 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:38:43.180 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:38:43.180 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:38:43.181 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:38:43.181 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:38:43.185 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 708 条 K 线数据。
2025-04-27 22:38:43.185 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:38:59.999000+00:00 的数据。
2025-04-27 22:38:43.185 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:38:59.999000+00:00)
2025-04-27 22:38:44.479 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 253 条获取到的 K 线存入数据库。
2025-04-27 22:38:44.481 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:38:44.482 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:38:44.482 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:38:44.735 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:38:44.757 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:38:45.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:38:45.741 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:38:46.629 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:38:46.819 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:38:46.922 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.44 秒。
2025-04-27 22:38:46.922 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:38:46.925 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:38:47.550 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:38:47.552 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:38:47.555 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:38:47.556 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:38:47.556 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:38:47.806 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:38:47.806 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 5.95 秒。
2025-04-27 22:38:47.807 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:38:47.808 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:38:47.808 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223847_808.html
2025-04-27 22:38:48.899 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223847_808.html
2025-04-27 22:38:48.900 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:39:41.554 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:39:43.289 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:39:43.289 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:39:43.289 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:39:43.289 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:39:43.290 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:39:43.290 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:39:43.291 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:39:43.291 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:39:43.292 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:39:43.294 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:39:43.294 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:39:43.294 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:39:43.298 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:39:44.520 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:39:44.520 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:39:44.521 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:39:44.521 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:39:44.524 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 707 条 K 线数据。
2025-04-27 22:39:44.525 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:41:59.999000+00:00 的数据。
2025-04-27 22:39:44.525 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:41:59.999000+00:00)
2025-04-27 22:39:46.172 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 254 条获取到的 K 线存入数据库。
2025-04-27 22:39:46.173 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:39:46.174 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:39:46.174 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:39:46.420 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:39:46.441 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:39:47.413 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:39:47.446 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:39:48.324 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:39:48.514 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:39:48.618 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.44 秒。
2025-04-27 22:39:48.619 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:39:48.622 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:39:49.288 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:39:49.289 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:39:49.292 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:39:49.293 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:39:49.293 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:39:49.546 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:39:49.546 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.25 秒。
2025-04-27 22:39:49.547 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:39:49.547 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:39:49.548 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223949_548.html
2025-04-27 22:39:50.637 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_223949_548.html
2025-04-27 22:39:50.637 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:40:38.187 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:40:39.874 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:40:39.874 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:40:39.874 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:40:39.874 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:40:39.875 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:40:39.875 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:40:39.877 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:40:39.877 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:40:39.877 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:40:39.878 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:40:39.878 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:40:39.879 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:40:39.883 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:40:41.777 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:40:41.777 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:40:41.777 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:40:41.778 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:40:41.781 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 707 条 K 线数据。
2025-04-27 22:40:41.782 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:41:59.999000+00:00 的数据。
2025-04-27 22:40:41.782 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:41:59.999000+00:00)
2025-04-27 22:40:43.070 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 254 条获取到的 K 线存入数据库。
2025-04-27 22:40:43.071 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:40:43.072 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:40:43.073 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:40:43.337 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:40:43.359 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:40:43.429 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93530.0000, 模式: short
2025-04-27 22:40:43.658 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (1.00%). 原模式: short, 入场价: 93530.0000, 当前价: 94574.0000
2025-04-27 22:40:44.261 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:40:44.265 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:40:44.345 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:40:44.375 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:40:44.704 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:40:44.764 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:40:45.313 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:40:45.516 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:40:45.630 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.56 秒。
2025-04-27 22:40:45.631 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:40:45.634 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:40:46.290 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:40:46.291 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:40:46.294 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:40:46.295 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:40:46.295 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:40:46.537 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:40:46.537 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.66 秒。
2025-04-27 22:40:46.538 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:40:46.539 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:40:46.540 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224046_539.html
2025-04-27 22:40:47.634 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224046_539.html
2025-04-27 22:40:47.635 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:41:45.568 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:41:47.226 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:41:47.226 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:41:47.226 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:41:47.226 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:41:47.226 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:41:47.227 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:41:47.228 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:41:47.228 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:41:47.229 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:41:47.230 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:41:47.230 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:41:47.230 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:41:47.234 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:41:48.483 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:41:48.484 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:41:48.484 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:41:48.484 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:41:48.487 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 707 条 K 线数据。
2025-04-27 22:41:48.488 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:41:59.999000+00:00 的数据。
2025-04-27 22:41:48.489 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:41:59.999000+00:00)
2025-04-27 22:41:49.787 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 254 条获取到的 K 线存入数据库。
2025-04-27 22:41:49.787 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:41:49.788 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:41:49.790 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:41:50.050 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:41:50.071 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:41:50.140 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93530.0000, 模式: short
2025-04-27 22:41:50.356 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (1.00%). 原模式: short, 入场价: 93530.0000, 当前价: 94574.0000
2025-04-27 22:41:50.962 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:41:50.966 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:41:51.050 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:41:51.081 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:41:51.392 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:41:51.455 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:41:52.020 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:41:52.217 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:41:52.329 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.54 秒。
2025-04-27 22:41:52.329 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:41:52.332 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:41:53.005 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:41:53.007 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:41:53.010 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:41:53.011 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:41:53.011 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:41:53.263 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:41:53.263 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.04 秒。
2025-04-27 22:41:53.264 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:41:53.265 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:41:53.265 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224153_265.html
2025-04-27 22:41:54.410 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224153_265.html
2025-04-27 22:41:54.411 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:42:11.890 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:42:13.411 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:42:13.412 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:42:13.412 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:42:13.412 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:42:13.412 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:42:13.412 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:42:13.414 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:42:13.415 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:42:13.415 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:42:13.416 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:42:13.416 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:42:13.417 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:42:13.420 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:42:14.866 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:42:14.866 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:42:14.867 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:42:14.867 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:42:14.870 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 706 条 K 线数据。
2025-04-27 22:42:14.871 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-25 00:00:00+00:00 到 2025-04-25 12:44:59.999000+00:00 的数据。
2025-04-27 22:42:14.871 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-25 00:00:00+00:00 to 2025-04-25 12:44:59.999000+00:00)
2025-04-27 22:42:16.213 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 255 条获取到的 K 线存入数据库。
2025-04-27 22:42:16.215 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 961 条。
2025-04-27 22:42:16.215 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 961 行数据，覆盖 961 个时间点。
2025-04-27 22:42:16.215 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:42:16.478 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:42:16.499 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:42:16.567 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93530.0000, 模式: short
2025-04-27 22:42:16.942 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (2.00%). 原模式: short, 入场价: 93530.0000, 当前价: 95435.3000
2025-04-27 22:42:17.370 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:42:17.373 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:42:17.455 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:42:17.485 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:42:17.777 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:42:17.839 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:42:18.379 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:42:18.574 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:42:18.680 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 2.46 秒。
2025-04-27 22:42:18.680 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:42:18.683 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:42:19.336 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:42:19.338 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:42:19.342 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:42:19.344 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:42:19.344 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:42:19.597 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:42:19.597 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 6.18 秒。
2025-04-27 22:42:19.598 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:42:19.598 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:42:19.600 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224219_600.html
2025-04-27 22:42:20.681 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224219_600.html
2025-04-27 22:42:20.682 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:43:14.119 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:43:15.869 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:43:15.869 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:43:15.869 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:43:15.869 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:43:15.869 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:43:15.869 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:43:15.872 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:43:15.872 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:43:15.873 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:43:15.874 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:43:15.874 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:43:15.874 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:43:15.879 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:43:17.218 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:43:17.218 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:43:17.218 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:43:17.219 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:43:17.223 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 481 条 K 线数据。
2025-04-27 22:43:17.224 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 481 行数据，覆盖 481 个时间点。
2025-04-27 22:43:17.224 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:43:17.539 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:43:17.599 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:43:18.119 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:43:18.304 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:43:18.407 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 1.18 秒。
2025-04-27 22:43:18.407 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:43:18.411 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.00 年，计算年化指标...
2025-04-27 22:43:19.086 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:43:19.088 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:43:19.091 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:43:19.092 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:43:19.092 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:43:19.346 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:43:19.346 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 3.47 秒。
2025-04-27 22:43:19.347 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:43:19.347 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:43:19.348 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224319_348.html
2025-04-27 22:43:20.425 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224319_348.html
2025-04-27 22:43:20.426 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:43:28.273 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:43:29.939 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:43:29.940 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:43:29.941 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:43:29.941 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:43:29.941 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:43:29.941 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:43:29.943 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:43:29.943 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:43:29.944 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:43:29.946 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:43:29.946 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:43:29.946 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:43:29.952 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:43:31.273 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:43:31.273 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:43:31.273 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:43:31.274 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:43:31.277 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 481 条 K 线数据。
2025-04-27 22:43:31.278 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 481 行数据，覆盖 481 个时间点。
2025-04-27 22:43:31.278 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:43:36.878 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:43:38.477 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:43:38.477 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:43:38.477 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:43:38.477 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:43:38.477 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:43:38.478 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:43:38.479 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:43:38.479 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:43:38.480 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:43:38.481 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:43:38.481 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:43:38.481 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:43:38.485 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:43:39.699 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:43:39.699 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:43:39.699 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:43:39.699 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:43:39.703 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 706 条 K 线数据。
2025-04-27 22:43:39.703 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-23 00:00:00+00:00 到 2025-04-25 12:44:59.999000+00:00 的数据。
2025-04-27 22:43:39.704 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-23 00:00:00+00:00 to 2025-04-25 12:44:59.999000+00:00)
2025-04-27 22:43:42.039 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 1215 条获取到的 K 线存入数据库。
2025-04-27 22:43:42.041 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1921 条。
2025-04-27 22:43:42.042 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1921 行数据，覆盖 1921 个时间点。
2025-04-27 22:43:42.042 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:43:42.112 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92825.3000, 模式: short
2025-04-27 22:43:42.139 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92825.3000, 当前价: 92718.5000
2025-04-27 22:43:42.287 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93437.2000, 模式: short
2025-04-27 22:43:42.291 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93437.2000, 当前价: 93520.9000
2025-04-27 22:43:42.723 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93621.5000, 模式: short
2025-04-27 22:43:42.735 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93621.5000, 当前价: 93365.6000
2025-04-27 22:43:43.135 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93701.1000, 模式: short
2025-04-27 22:43:43.142 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93701.1000, 当前价: 93826.6000
2025-04-27 22:43:43.602 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92650.8000, 模式: short
2025-04-27 22:43:43.608 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92650.8000, 当前价: 92556.1000
2025-04-27 22:43:43.715 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92340.8000, 模式: short
2025-04-27 22:43:43.730 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92340.8000, 当前价: 92191.0000
2025-04-27 22:43:44.070 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92588.8000, 模式: short
2025-04-27 22:43:45.534 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (3.00%). 原模式: short, 入场价: 92588.8000, 当前价: 95435.3000
2025-04-27 22:43:46.037 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:43:46.042 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:43:46.127 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:43:46.162 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:43:46.497 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:43:46.565 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:43:47.194 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:43:47.413 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:43:47.530 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 5.49 秒。
2025-04-27 22:43:47.530 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:43:47.534 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:43:48.197 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:43:48.199 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:43:48.202 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:43:48.203 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:43:48.203 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:43:48.455 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:43:48.456 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 9.98 秒。
2025-04-27 22:43:48.457 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:43:48.458 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:43:48.459 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224348_459.html
2025-04-27 22:43:49.698 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224348_459.html
2025-04-27 22:43:49.699 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:44:40.292 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:44:42.052 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:44:42.052 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:44:42.053 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:44:42.053 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:44:42.053 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:44:42.054 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:44:42.056 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:44:42.056 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:44:42.056 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:44:42.057 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:44:42.058 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:44:42.058 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:44:42.064 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:44:43.449 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:44:43.450 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:44:43.450 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:44:43.450 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:44:43.454 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 706 条 K 线数据。
2025-04-27 22:44:43.455 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:455 | [BTC/USDT:USDT] 数据库数据起始晚于请求，需要获取 2025-04-23 00:00:00+00:00 到 2025-04-25 12:44:59.999000+00:00 的数据。
2025-04-27 22:44:43.455 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-23 00:00:00+00:00 to 2025-04-25 12:44:59.999000+00:00)
2025-04-27 22:44:45.710 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 1215 条获取到的 K 线存入数据库。
2025-04-27 22:44:45.712 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 1921 条。
2025-04-27 22:44:45.714 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 1921 行数据，覆盖 1921 个时间点。
2025-04-27 22:44:45.714 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:44:45.793 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92825.3000, 模式: short
2025-04-27 22:44:45.821 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92825.3000, 当前价: 92718.5000
2025-04-27 22:44:45.972 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93437.2000, 模式: short
2025-04-27 22:44:45.976 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93437.2000, 当前价: 93520.9000
2025-04-27 22:44:46.412 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93621.5000, 模式: short
2025-04-27 22:44:46.422 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93621.5000, 当前价: 93365.6000
2025-04-27 22:44:46.843 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93701.1000, 模式: short
2025-04-27 22:44:46.852 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93701.1000, 当前价: 93826.6000
2025-04-27 22:44:47.360 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92650.8000, 模式: short
2025-04-27 22:44:47.367 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92650.8000, 当前价: 92556.1000
2025-04-27 22:44:47.497 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92340.8000, 模式: short
2025-04-27 22:44:47.513 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 92340.8000, 当前价: 92191.0000
2025-04-27 22:44:47.841 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 92588.8000, 模式: short
2025-04-27 22:44:47.865 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 92588.8000, 当前价: 93068.3000
2025-04-27 22:44:48.256 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93358.7000, 模式: short
2025-04-27 22:44:48.281 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93358.7000, 当前价: 93181.6000
2025-04-27 22:44:48.376 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93473.5000, 模式: short
2025-04-27 22:44:48.397 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93473.5000, 当前价: 93644.0000
2025-04-27 22:44:48.773 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 93261.8000, 模式: short
2025-04-27 22:44:48.795 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 93261.8000, 当前价: 93375.1000
2025-04-27 22:44:48.865 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 93530.0000, 模式: short
2025-04-27 22:44:49.073 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 93530.0000, 当前价: 94000.5000
2025-04-27 22:44:49.713 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94807.4000, 模式: short
2025-04-27 22:44:49.717 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94807.4000, 当前价: 94702.5000
2025-04-27 22:44:49.799 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94842.1000, 模式: short
2025-04-27 22:44:49.830 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94842.1000, 当前价: 95030.3000
2025-04-27 22:44:50.134 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 94611.0000, 模式: short
2025-04-27 22:44:50.200 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94611.0000, 当前价: 94516.0000
2025-04-27 22:44:50.773 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 94304.7000, 模式: short
2025-04-27 22:44:50.973 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 94304.7000, 当前价: 94419.0000
2025-04-27 22:44:51.087 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 5.37 秒。
2025-04-27 22:44:51.087 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:44:51.091 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 22:44:51.745 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:44:51.746 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:44:51.749 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:44:51.751 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:44:51.751 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:44:51.998 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:44:51.998 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 9.94 秒。
2025-04-27 22:44:51.999 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:44:52.000 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:44:52.001 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224452_001.html
2025-04-27 22:44:53.178 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224452_001.html
2025-04-27 22:44:53.179 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:45:25.715 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:45:27.328 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:45:27.328 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:45:27.329 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:45:27.329 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:45:27.329 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:45:27.329 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:45:27.331 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:45:27.331 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:45:27.331 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:45:27.332 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:45:27.333 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:45:27.333 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:45:27.338 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:45:29.113 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:45:29.113 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:45:29.113 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:45:29.113 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:45:29.117 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:45:29.117 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:45:29.117 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:45:33.785 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:45:33.787 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:45:33.788 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:45:33.789 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:45:33.839 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:45:33.896 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83229.4000, 当前价: 82776.0000
2025-04-27 22:45:34.065 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:45:34.075 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83390.5000, 当前价: 83479.8000
2025-04-27 22:45:34.140 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:45:34.183 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83543.6000, 当前价: 83966.9000
2025-04-27 22:45:34.930 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:45:34.934 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 85327.6000, 当前价: 85255.6000
2025-04-27 22:45:35.050 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:45:35.076 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:45:35.741 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:45:35.745 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:45:36.325 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:45:36.378 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83255.8000, 当前价: 83719.5000
2025-04-27 22:45:39.375 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:45:39.379 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:45:39.436 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:45:39.450 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 22:45:40.637 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:45:40.650 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:45:41.135 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:45:41.178 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 84263.6000, 当前价: 84690.9000
2025-04-27 22:45:41.927 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:45:42.011 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84923.6000, 当前价: 84992.2000
2025-04-27 22:45:42.104 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:45:42.133 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84820.9000, 当前价: 84745.3000
2025-04-27 22:45:42.192 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 22:45:42.200 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 22:45:42.391 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:45:42.406 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:45:42.624 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:45:42.844 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84506.0000, 当前价: 84418.2000
2025-04-27 22:45:43.045 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:45:43.057 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 22:45:43.209 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:45:43.392 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:45:43.455 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:45:43.638 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 84342.9000, 当前价: 84770.9000
2025-04-27 22:45:44.396 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85307.8000, 模式: short
2025-04-27 22:45:44.422 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 85307.8000, 当前价: 85156.8000
2025-04-27 22:45:44.927 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 11.14 秒。
2025-04-27 22:45:44.928 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:45:44.935 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:45:45.598 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:45:45.600 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:45:45.603 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:45:45.605 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:45:45.605 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:45:45.849 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:45:45.849 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 18.52 秒。
2025-04-27 22:45:45.850 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:45:45.851 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:45:45.852 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224545_852.html
2025-04-27 22:45:47.163 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224545_852.html
2025-04-27 22:45:47.165 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:46:17.086 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:46:18.671 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:46:18.672 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:46:18.672 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:46:18.672 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:46:18.672 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:46:18.672 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:46:18.674 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:46:18.674 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:46:18.675 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:46:18.691 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:46:18.691 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:46:18.692 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:46:18.696 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:46:20.158 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:46:20.158 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:46:20.158 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:46:20.158 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:46:20.162 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:46:20.163 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:46:20.163 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:46:24.183 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:46:24.184 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:46:24.185 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:46:24.185 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:46:24.229 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:46:24.407 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 22:46:24.460 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:46:24.468 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83390.5000, 当前价: 83479.8000
2025-04-27 22:46:24.537 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:46:24.632 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83543.6000, 当前价: 83444.3000
2025-04-27 22:46:25.308 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:46:25.312 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 85327.6000, 当前价: 85255.6000
2025-04-27 22:46:25.434 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:46:25.460 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:46:26.130 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:46:26.134 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:46:26.717 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:46:26.912 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (2.00%). 原模式: short, 入场价: 83255.8000, 当前价: 84994.7000
2025-04-27 22:46:29.767 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:46:29.771 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:46:29.815 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:46:29.824 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 22:46:30.983 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:46:30.995 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:46:31.462 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:46:31.627 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 22:46:32.179 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:46:32.253 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84923.6000, 当前价: 84992.2000
2025-04-27 22:46:32.331 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:46:32.357 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84820.9000, 当前价: 84745.3000
2025-04-27 22:46:32.414 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 22:46:32.421 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 22:46:32.591 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:46:32.605 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:46:32.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:46:33.010 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84506.0000, 当前价: 84418.2000
2025-04-27 22:46:33.191 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:46:33.201 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 22:46:33.342 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:46:33.518 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.08%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:46:33.574 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:46:34.995 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.81 秒。
2025-04-27 22:46:34.996 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:46:35.003 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:46:35.649 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:46:35.650 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:46:35.653 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:46:35.654 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:46:35.655 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:46:35.905 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:46:35.905 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 17.23 秒。
2025-04-27 22:46:35.906 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:46:35.907 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:46:35.907 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224635_907.html
2025-04-27 22:46:37.148 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224635_907.html
2025-04-27 22:46:37.149 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:46:59.833 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:47:01.368 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:47:01.368 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:47:01.368 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:47:01.368 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:47:01.368 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:47:01.369 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:47:01.370 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:47:01.371 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:47:01.371 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:47:01.372 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:47:01.372 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:47:01.373 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:47:01.377 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:47:02.880 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:47:02.880 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:47:02.881 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:47:02.881 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:47:02.885 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:47:02.885 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:47:02.885 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:47:07.226 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:47:07.227 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:47:07.229 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:47:07.229 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:47:07.275 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:47:07.460 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 22:47:07.511 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:47:07.520 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83390.5000, 当前价: 83479.8000
2025-04-27 22:47:07.586 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:47:07.681 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83543.6000, 当前价: 83444.3000
2025-04-27 22:47:08.353 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:47:08.428 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 22:47:08.471 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:47:08.496 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:47:09.141 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:47:09.145 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:47:09.715 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:47:11.393 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (3.00%). 原模式: short, 入场价: 83255.8000, 当前价: 85777.0000
2025-04-27 22:47:12.706 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:47:12.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:47:12.758 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:47:12.767 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 22:47:13.905 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:47:13.914 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:47:14.363 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:47:14.530 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 22:47:15.070 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:47:15.153 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 22:47:15.219 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:47:15.264 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84820.9000, 当前价: 84725.0000
2025-04-27 22:47:15.301 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 22:47:15.307 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 22:47:15.475 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:47:15.489 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:47:15.669 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:47:15.874 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84506.0000, 当前价: 84418.2000
2025-04-27 22:47:16.057 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:47:16.066 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 22:47:16.207 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:47:16.375 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:47:16.433 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:47:17.795 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.57 秒。
2025-04-27 22:47:17.795 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:47:17.801 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:47:18.399 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:47:18.400 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:47:18.403 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:47:18.405 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:47:18.405 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:47:18.657 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:47:18.657 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 17.29 秒。
2025-04-27 22:47:18.658 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:47:18.659 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:47:18.659 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224718_659.html
2025-04-27 22:47:19.888 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224718_659.html
2025-04-27 22:47:19.890 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:47:36.736 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:47:38.431 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:47:38.431 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:47:38.431 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:47:38.431 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:47:38.431 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:47:38.431 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:47:38.434 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:47:38.434 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:47:38.435 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:47:38.436 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:47:38.436 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:47:38.436 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:47:38.440 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:47:40.133 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:47:40.134 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:47:40.134 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:47:40.134 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:47:40.138 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:47:40.138 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:47:40.138 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:47:43.943 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:47:43.944 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:47:43.945 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:47:43.945 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:47:43.991 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:47:44.161 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 22:47:44.215 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:47:44.236 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 22:47:44.297 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:47:44.414 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 22:47:45.089 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:47:45.175 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 22:47:45.220 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:47:45.248 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:47:45.904 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:47:45.908 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:47:46.495 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:47:49.567 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 22:47:49.875 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:47:49.881 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:47:49.943 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:47:49.989 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 22:47:51.331 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:47:51.346 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:47:51.845 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:47:52.024 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 22:47:52.619 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:47:52.723 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 22:47:52.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:47:52.888 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 22:47:53.070 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:47:53.084 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:47:53.284 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:47:53.511 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 22:47:53.712 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:47:53.750 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 22:47:53.868 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:47:54.054 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:47:54.112 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:47:55.587 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 11.64 秒。
2025-04-27 22:47:55.587 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:47:55.594 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:47:56.265 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:47:56.266 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:47:56.269 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:47:56.270 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:47:56.270 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:47:56.522 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:47:56.522 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 18.09 秒。
2025-04-27 22:47:56.523 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:47:56.524 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:47:56.524 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224756_524.html
2025-04-27 22:47:57.793 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_224756_524.html
2025-04-27 22:47:57.794 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:51:01.131 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:51:02.688 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:51:02.688 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:51:02.688 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:51:02.688 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:51:02.688 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:51:02.688 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:51:02.689 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:51:02.690 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:51:02.690 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:51:02.691 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:51:02.691 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:51:02.692 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:51:02.696 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:51:04.157 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:51:04.158 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:51:04.158 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:51:04.158 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:51:04.162 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:51:04.162 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:51:04.162 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:51:07.826 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:51:07.827 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:51:07.829 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:51:07.829 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:51:07.872 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:51:08.050 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 83229.4000, 当前价: 83437.3000
2025-04-27 22:51:08.088 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:51:08.110 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 83390.5000, 当前价: 83573.2000
2025-04-27 22:51:08.164 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:51:08.319 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 83543.6000, 当前价: 83371.3000
2025-04-27 22:51:08.939 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:51:09.023 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 85327.6000, 当前价: 85149.8000
2025-04-27 22:51:09.056 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:51:09.083 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 85247.2000, 当前价: 84983.2000
2025-04-27 22:51:09.733 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:51:09.797 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.20%). 原模式: short, 入场价: 84354.6000, 当前价: 84138.6000
2025-04-27 22:51:10.322 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:51:18.381 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.55 秒。
2025-04-27 22:51:18.381 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:51:18.387 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:51:19.041 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:51:19.043 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:51:19.045 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:51:19.046 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:51:19.046 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:51:19.298 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:51:19.298 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.61 秒。
2025-04-27 22:51:19.300 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:51:19.300 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:51:19.301 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225119_301.html
2025-04-27 22:51:20.512 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225119_301.html
2025-04-27 22:51:20.513 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:51:44.606 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:51:46.486 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:51:46.486 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:51:46.486 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:51:46.487 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0002/0.0004
2025-04-27 22:51:46.487 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:51:46.487 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:51:46.488 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:51:46.489 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:51:46.489 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:51:46.490 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:51:46.490 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:51:46.491 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:51:46.495 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:51:52.262 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:51:52.262 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:51:52.262 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:51:52.264 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:51:52.267 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:51:52.268 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:51:52.268 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:51:52.268 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:51:57.921 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:52:02.925 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:52:08.537 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 2/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:52:18.541 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:52:24.306 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 3/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:52:24.306 | ERROR    | MainThread      | backtest.engine:_fetch_and_store_data:263 | [BTC/USDT:USDT] 达到最大重试次数，放弃获取此分段。
2025-04-27 22:52:24.306 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:273 | [BTC/USDT:USDT] 未能从交易所获取到任何 K 线数据。
2025-04-27 22:52:24.308 | WARNING  | MainThread      | backtest.engine:_prepare_data:354 | [BTC/USDT:USDT] 未能准备有效数据，将跳过该交易对。
2025-04-27 22:52:24.309 | ERROR    | MainThread      | backtest.engine:run:1038 | 回测过程中发生严重错误: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:52:24.310 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:52:24.310 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:52:24.562 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:52:24.562 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 38.07 秒。
2025-04-27 22:52:24.562 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:52:24.563 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:52:42.723 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:52:44.411 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:52:44.411 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:52:44.411 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:52:44.411 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.0002
2025-04-27 22:52:44.411 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:52:44.411 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:52:44.413 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:52:44.413 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:52:44.414 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:52:44.415 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:52:44.415 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:52:44.415 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:52:44.419 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:52:49.990 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:52:49.990 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:52:49.991 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:52:49.992 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:52:49.996 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:52:49.996 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:52:49.996 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:52:49.997 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:52:55.688 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:53:00.691 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:53:06.097 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:53:07.769 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:53:07.769 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:53:07.769 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:53:07.769 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.0002
2025-04-27 22:53:07.769 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:53:07.770 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:53:07.771 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:53:07.772 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:53:07.772 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:53:07.773 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:53:07.774 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:53:07.774 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:53:07.778 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:53:17.776 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:53:17.776 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:53:17.776 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:53:17.778 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:53:17.782 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:53:17.782 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:53:17.782 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:53:17.782 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:53:24.052 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://sapi.xt.com/v4/public/wallet/support/currency
2025-04-27 22:53:29.059 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:53:32.136 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 2/3 次): xt GET https://sapi.xt.com/v4/public/wallet/support/currency
2025-04-27 22:53:42.131 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:53:50.901 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 3/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:53:50.901 | ERROR    | MainThread      | backtest.engine:_fetch_and_store_data:263 | [BTC/USDT:USDT] 达到最大重试次数，放弃获取此分段。
2025-04-27 22:53:50.901 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:273 | [BTC/USDT:USDT] 未能从交易所获取到任何 K 线数据。
2025-04-27 22:53:50.903 | WARNING  | MainThread      | backtest.engine:_prepare_data:354 | [BTC/USDT:USDT] 未能准备有效数据，将跳过该交易对。
2025-04-27 22:53:50.904 | ERROR    | MainThread      | backtest.engine:run:1038 | 回测过程中发生严重错误: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:53:50.905 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:53:50.905 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:53:51.156 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:53:51.156 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 43.38 秒。
2025-04-27 22:53:51.156 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:53:51.157 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:53:59.868 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:54:01.540 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:54:01.540 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:54:01.541 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:54:01.541 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.0002
2025-04-27 22:54:01.541 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:54:01.541 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:54:01.543 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:54:01.543 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:54:01.544 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:54:01.545 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:54:01.545 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:54:01.545 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:54:01.549 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:54:11.138 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:54:11.139 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:54:11.139 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:54:11.140 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:54:11.143 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:54:11.144 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:54:11.144 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:54:11.144 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:54:20.349 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://fapi.xt.com/future/market/v1/public/symbol/list
2025-04-27 22:54:25.352 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:54:38.188 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 2/3 次): xt GET https://fapi.xt.com/future/market/v1/public/q/kline?interval=3m&limit=1000&startTime=1744416000000&symbol=btc_usdt
2025-04-27 22:54:52.401 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:54:52.402 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:54:52.403 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:54:52.404 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:54:52.450 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:54:52.613 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 22:54:52.665 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:54:52.686 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 22:54:52.745 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:54:52.870 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 22:54:53.555 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:54:53.627 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 22:54:53.670 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:54:53.694 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:54:54.361 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:54:54.365 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:54:54.955 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:54:57.872 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 22:54:58.142 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:54:58.146 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:54:58.192 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:54:58.227 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 22:54:59.362 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:54:59.373 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:54:59.814 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:54:59.980 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 22:55:00.548 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:55:00.636 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 22:55:00.703 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:55:00.784 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 22:55:00.966 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:55:00.981 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:55:01.173 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:55:01.385 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 22:55:01.578 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:55:01.614 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 22:55:01.729 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:55:01.903 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:55:01.957 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:55:03.315 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.91 秒。
2025-04-27 22:55:03.316 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:55:03.323 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:55:03.958 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:55:03.959 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:55:03.963 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:55:03.964 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:55:03.964 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:55:04.216 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:55:04.216 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 62.67 秒。
2025-04-27 22:55:04.217 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:55:04.217 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:55:04.218 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225504_218.html
2025-04-27 22:55:05.383 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225504_218.html
2025-04-27 22:55:05.384 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:56:03.063 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:56:04.785 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:56:04.785 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:56:04.785 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:56:04.786 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 22:56:04.786 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:56:04.786 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:56:04.787 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:56:04.788 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:56:04.788 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:56:04.789 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:56:04.789 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:56:04.789 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:56:04.793 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:56:09.896 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 22:56:09.896 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:56:09.896 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:56:09.897 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:56:09.900 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:56:09.900 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:56:09.901 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:56:09.901 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:56:15.102 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 22:56:20.104 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:56:25.308 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 2/3 次): xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 22:56:35.310 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:56:40.512 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 3/3 次): xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 22:56:40.513 | ERROR    | MainThread      | backtest.engine:_fetch_and_store_data:263 | [BTC/USDT:USDT] 达到最大重试次数，放弃获取此分段。
2025-04-27 22:56:40.513 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:273 | [BTC/USDT:USDT] 未能从交易所获取到任何 K 线数据。
2025-04-27 22:56:40.514 | WARNING  | MainThread      | backtest.engine:_prepare_data:354 | [BTC/USDT:USDT] 未能准备有效数据，将跳过该交易对。
2025-04-27 22:56:40.514 | ERROR    | MainThread      | backtest.engine:run:1038 | 回测过程中发生严重错误: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:56:40.515 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:56:40.515 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:56:40.768 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:56:40.769 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 35.98 秒。
2025-04-27 22:56:40.769 | ERROR    | MainThread      | __main__:main:220 | 回测执行失败: 未能为任何指定的交易对准备数据。回测无法进行。
2025-04-27 22:56:40.769 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 22:57:17.012 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:57:18.670 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:57:18.670 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:57:18.671 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:57:18.671 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 22:57:18.671 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:57:18.671 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:57:18.673 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:57:18.673 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:57:18.674 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:57:18.675 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:57:18.675 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:57:18.675 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:57:18.679 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:57:23.697 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://sapi.xt.com/v4/public/wallet/support/currency
2025-04-27 22:57:23.697 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:57:23.698 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:57:23.698 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:57:23.701 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:57:23.702 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:57:23.702 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:57:23.702 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:57:28.803 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://sapi.xt.com/v4/public/wallet/support/currency
2025-04-27 22:57:33.811 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 22:57:38.915 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 2/3 次): xt GET https://sapi.xt.com/v4/public/wallet/support/currency
2025-04-27 22:57:48.619 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 22:57:51.197 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:57:51.197 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 22:57:51.198 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 22:57:51.198 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 22:57:51.198 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 22:57:51.198 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 22:57:51.200 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 22:57:51.200 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 22:57:51.200 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 22:57:51.201 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 22:57:51.202 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 22:57:51.202 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 22:57:51.207 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 22:57:52.773 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 22:57:52.774 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 22:57:52.774 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 22:57:52.774 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 22:57:52.779 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 22:57:52.779 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 22:57:52.779 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 22:57:56.517 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 22:57:56.518 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 22:57:56.519 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 22:57:56.519 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 22:57:56.563 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 22:57:56.725 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 22:57:56.778 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 22:57:56.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 22:57:56.857 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 22:57:56.975 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 22:57:57.652 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 22:57:57.725 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 22:57:57.771 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 22:57:57.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 22:57:58.457 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 22:57:58.461 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 22:57:59.040 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 22:58:01.843 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 22:58:02.109 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 22:58:02.113 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 22:58:02.157 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 22:58:02.192 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 22:58:03.314 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 22:58:03.323 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 22:58:03.772 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 22:58:03.933 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 22:58:04.485 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 22:58:04.571 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 22:58:04.637 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 22:58:04.722 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 22:58:04.893 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 22:58:04.905 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 22:58:05.090 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 22:58:05.299 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 22:58:05.480 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 22:58:05.515 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 22:58:05.627 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 22:58:05.806 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 22:58:05.861 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 22:58:07.244 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.72 秒。
2025-04-27 22:58:07.245 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 22:58:07.252 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 22:58:07.924 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 22:58:07.925 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 22:58:07.928 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 22:58:07.929 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 22:58:07.930 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 22:58:08.179 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 22:58:08.179 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.98 秒。
2025-04-27 22:58:08.180 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 22:58:08.180 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 22:58:08.181 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225808_181.html
2025-04-27 22:58:09.495 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_225808_181.html
2025-04-27 22:58:09.496 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:00:41.751 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:00:43.560 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:00:43.560 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:00:43.560 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:00:43.560 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:00:43.560 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:00:43.561 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:00:43.563 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:00:43.563 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:00:43.564 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:00:43.565 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:00:43.565 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:00:43.566 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:00:43.570 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:00:48.672 | ERROR    | MainThread      | trading.api:_load_markets:135 | 加载 xt 市场信息失败: xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 23:00:48.673 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:00:48.673 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:00:48.673 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:00:48.676 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:00:48.677 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:00:48.677 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:00:48.677 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 23:00:53.879 | WARNING  | MainThread      | backtest.engine:_fetch_and_store_data:258 | [BTC/USDT:USDT] 获取 K 线数据时出错 (第 1/3 次): xt GET https://sapi.xt.com/v4/public/currencies
2025-04-27 23:00:58.866 | ERROR    | MainThread      | trading.api:_format_symbol:159 | 格式化交易对 BTC/USDT:USDT 时出错: xt markets not loaded
2025-04-27 23:01:04.159 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:01:04.160 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:01:04.162 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:01:04.162 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:01:04.212 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:01:04.402 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:01:04.465 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:01:04.485 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 23:01:04.543 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:01:04.679 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 23:01:05.449 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:01:05.530 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:01:05.574 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:01:05.605 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:01:06.318 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:01:06.323 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:01:06.993 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:01:10.241 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 23:01:10.515 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:01:10.520 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:01:10.571 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:01:10.614 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 23:01:11.883 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:01:11.893 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:01:12.376 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:01:12.573 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:01:13.180 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:01:13.274 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:01:13.346 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:01:13.467 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 23:01:13.694 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:01:13.711 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:01:13.921 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:01:14.163 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 23:01:14.376 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:01:14.419 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 23:01:14.565 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:01:14.769 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:01:14.832 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:01:16.208 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 12.05 秒。
2025-04-27 23:01:16.208 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:01:16.214 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:01:16.866 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:01:16.869 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:01:16.873 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:01:16.876 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:01:16.876 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:01:17.129 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:01:17.129 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 33.57 秒。
2025-04-27 23:01:17.131 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:01:17.131 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:01:17.132 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230117_132.html
2025-04-27 23:01:18.452 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230117_132.html
2025-04-27 23:01:18.454 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:01:56.197 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:01:57.736 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:01:57.737 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:01:57.737 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:01:57.737 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:01:57.737 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:01:57.738 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:01:57.739 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:01:57.740 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:01:57.740 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:01:57.741 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:01:57.741 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:01:57.741 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:01:57.745 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:01:58.866 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:01:58.866 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:01:58.866 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:01:58.867 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:01:58.870 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:01:58.870 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:01:58.871 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:02:02.442 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:02:02.443 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:02:02.444 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:02:02.444 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:02:02.489 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:02:02.646 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:02:02.695 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:02:02.715 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 23:02:02.770 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:02:02.878 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 23:02:03.544 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:02:03.622 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:02:03.665 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:02:03.690 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:02:04.329 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:02:04.333 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:02:04.897 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:02:07.634 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 23:02:07.874 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:02:07.878 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:02:07.922 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:02:07.956 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 23:02:09.075 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:02:09.085 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:02:09.534 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:02:09.712 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:02:10.295 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:02:10.384 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:02:10.450 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:02:10.531 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 23:02:10.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:02:10.723 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:02:10.907 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:02:11.117 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 23:02:11.299 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:02:11.334 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 23:02:11.457 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:02:11.627 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:02:11.683 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:02:13.078 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.63 秒。
2025-04-27 23:02:13.078 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:02:13.085 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:02:13.085 | WARNING  | MainThread      | backtest.results:calculate_metrics:120 | 计算年化回报 (CAGR) 失败: name 'trading_days_per_year' is not defined
2025-04-27 23:02:13.085 | WARNING  | MainThread      | backtest.results:calculate_metrics:128 | 计算年化波动率失败: name 'trading_days_per_year' is not defined
2025-04-27 23:02:13.795 | WARNING  | MainThread      | backtest.results:calculate_metrics:169 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:02:13.796 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:02:13.796 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:02:14.051 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:02:14.051 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.31 秒。
2025-04-27 23:02:14.052 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:02:14.053 | INFO     | MainThread      | backtest.results:generate_report_html:281 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:02:14.053 | INFO     | MainThread      | backtest.results:generate_report_html:296 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230214_053.html
2025-04-27 23:02:15.318 | INFO     | MainThread      | backtest.results:generate_report_html:306 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230214_053.html
2025-04-27 23:02:15.319 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:02:37.621 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:02:39.228 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:02:39.228 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:02:39.228 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:02:39.228 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:02:39.229 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:02:39.229 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:02:39.230 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:02:39.230 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:02:39.231 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:02:39.232 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:02:39.232 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:02:39.232 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:02:39.236 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:02:40.409 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:02:40.410 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:02:40.410 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:02:40.410 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:02:40.414 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:02:40.415 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:02:40.415 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:02:44.043 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:02:44.044 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:02:44.045 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:02:44.045 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:02:44.091 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:02:44.279 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:02:44.335 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:02:44.345 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83390.5000, 当前价: 83479.8000
2025-04-27 23:02:44.421 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:02:44.539 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83543.6000, 当前价: 83444.3000
2025-04-27 23:02:45.277 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:02:45.358 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:02:45.409 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:02:45.442 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:02:46.167 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:02:46.172 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:02:46.794 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:02:49.937 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 23:02:50.210 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:02:50.214 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:02:50.267 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:02:50.277 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 23:02:51.522 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:02:51.533 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:02:52.059 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:02:52.234 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:02:52.821 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:02:52.908 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:02:52.982 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:02:53.035 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84820.9000, 当前价: 84725.0000
2025-04-27 23:02:53.083 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 23:02:53.093 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 23:02:53.277 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:02:53.292 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:02:53.511 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:02:53.742 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84506.0000, 当前价: 84418.2000
2025-04-27 23:02:53.937 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:02:53.947 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 23:02:54.098 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:02:54.277 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:02:54.334 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:02:55.857 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 11.81 秒。
2025-04-27 23:02:55.858 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:02:55.865 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:02:55.866 | WARNING  | MainThread      | backtest.results:calculate_metrics:120 | 计算年化回报 (CAGR) 失败: name 'trading_days_per_year' is not defined
2025-04-27 23:02:55.866 | WARNING  | MainThread      | backtest.results:calculate_metrics:128 | 计算年化波动率失败: name 'trading_days_per_year' is not defined
2025-04-27 23:02:56.542 | WARNING  | MainThread      | backtest.results:calculate_metrics:169 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:02:56.543 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:02:56.543 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:02:56.794 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:02:56.794 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 17.56 秒。
2025-04-27 23:02:56.796 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:02:56.797 | INFO     | MainThread      | backtest.results:generate_report_html:281 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:02:56.797 | INFO     | MainThread      | backtest.results:generate_report_html:296 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230256_797.html
2025-04-27 23:02:58.179 | INFO     | MainThread      | backtest.results:generate_report_html:306 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_230256_797.html
2025-04-27 23:02:58.180 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:03:40.958 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:03:42.548 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:03:42.548 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:03:42.548 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:03:42.548 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:03:42.549 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:03:42.549 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:03:42.550 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:03:42.551 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:03:42.551 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:03:42.553 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:03:42.553 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:03:42.553 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:03:42.558 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:03:43.854 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:03:43.854 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:03:43.854 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:03:43.855 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:03:43.858 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:03:43.859 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:03:43.859 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2024-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:06:34.792 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 179041 条获取到的 K 线存入数据库。
2025-04-27 23:06:34.813 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 179041 条。
2025-04-27 23:06:34.825 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 179041 行数据，覆盖 179041 个时间点。
2025-04-27 23:06:34.825 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:06:43.282 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 67392.6000, 模式: short
2025-04-27 23:06:43.300 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67392.6000, 当前价: 67281.4000
2025-04-27 23:06:45.406 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67606.2000, 模式: short
2025-04-27 23:06:45.420 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67606.2000, 当前价: 67687.7000
2025-04-27 23:06:53.055 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64046.7000, 模式: short
2025-04-27 23:06:53.213 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64046.7000, 当前价: 63834.5000
2025-04-27 23:06:57.038 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66346.3000, 模式: short
2025-04-27 23:06:57.053 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66346.3000, 当前价: 66277.2000
2025-04-27 23:07:00.565 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63299.1000, 模式: short
2025-04-27 23:07:00.593 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63299.1000, 当前价: 63181.7000
2025-04-27 23:07:03.948 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63082.0000, 模式: short
2025-04-27 23:07:04.029 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63082.0000, 当前价: 63201.7000
2025-04-27 23:07:04.070 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62787.7000, 模式: short
2025-04-27 23:07:04.098 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62787.7000, 当前价: 62649.3000
2025-04-27 23:07:05.273 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62820.1000, 模式: short
2025-04-27 23:07:05.287 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62820.1000, 当前价: 62928.8000
2025-04-27 23:07:06.717 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63707.3000, 模式: short
2025-04-27 23:07:07.200 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63707.3000, 当前价: 63634.8000
2025-04-27 23:07:15.707 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61013.6000, 模式: short
2025-04-27 23:07:15.725 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61013.6000, 当前价: 60911.3000
2025-04-27 23:07:19.442 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63336.6000, 模式: short
2025-04-27 23:07:19.722 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63336.6000, 当前价: 63245.8000
2025-04-27 23:07:19.937 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63363.3000, 模式: short
2025-04-27 23:07:20.217 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63363.3000, 当前价: 63271.4000
2025-04-27 23:07:25.126 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63998.9000, 模式: short
2025-04-27 23:07:26.016 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63998.9000, 当前价: 63825.6000
2025-04-27 23:07:28.257 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63921.9000, 模式: short
2025-04-27 23:07:28.300 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63921.9000, 当前价: 64092.0000
2025-04-27 23:07:28.937 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64016.8000, 模式: short
2025-04-27 23:07:29.205 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64016.8000, 当前价: 63921.7000
2025-04-27 23:07:29.901 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63451.0000, 模式: short
2025-04-27 23:07:45.887 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 63451.0000, 当前价: 66710.7000
2025-04-27 23:07:47.024 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66509.2000, 模式: short
2025-04-27 23:07:47.118 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66509.2000, 当前价: 66584.2000
2025-04-27 23:07:49.513 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66452.8000, 模式: short
2025-04-27 23:07:49.609 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66452.8000, 当前价: 66313.5000
2025-04-27 23:07:50.564 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66138.9000, 模式: short
2025-04-27 23:07:50.619 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66138.9000, 当前价: 66222.4000
2025-04-27 23:07:51.104 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66050.1000, 模式: short
2025-04-27 23:07:51.433 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66050.1000, 当前价: 66210.8000
2025-04-27 23:07:57.060 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66530.8000, 模式: short
2025-04-27 23:07:57.198 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66530.8000, 当前价: 66423.2000
2025-04-27 23:08:01.659 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63972.7000, 模式: short
2025-04-27 23:08:04.158 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63972.7000, 当前价: 63898.8000
2025-04-27 23:08:07.709 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64506.9000, 模式: short
2025-04-27 23:08:08.612 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64506.9000, 当前价: 64420.6000
2025-04-27 23:08:09.536 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 64473.5000, 模式: short
2025-04-27 23:08:12.815 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64473.5000, 当前价: 64559.4000
2025-04-27 23:08:13.662 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63683.2000, 模式: short
2025-04-27 23:08:13.690 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63683.2000, 当前价: 63762.0000
2025-04-27 23:08:14.614 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63895.0000, 模式: short
2025-04-27 23:08:14.805 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63895.0000, 当前价: 63810.7000
2025-04-27 23:08:17.144 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62954.2000, 模式: short
2025-04-27 23:08:17.348 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62954.2000, 当前价: 62871.6000
2025-04-27 23:08:18.057 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62895.6000, 模式: short
2025-04-27 23:08:18.506 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62895.6000, 当前价: 62782.1000
2025-04-27 23:08:18.884 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62904.8000, 模式: short
2025-04-27 23:08:18.898 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62904.8000, 当前价: 63067.8000
2025-04-27 23:08:22.876 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63623.8000, 模式: short
2025-04-27 23:08:22.920 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63623.8000, 当前价: 63693.0000
2025-04-27 23:08:26.845 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63480.7000, 模式: short
2025-04-27 23:08:28.759 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63480.7000, 当前价: 63026.6000
2025-04-27 23:08:29.809 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63135.8000, 模式: short
2025-04-27 23:08:29.895 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63135.8000, 当前价: 63064.4000
2025-04-27 23:08:32.994 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62246.0000, 模式: short
2025-04-27 23:08:33.014 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62246.0000, 当前价: 62148.8000
2025-04-27 23:08:33.032 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62377.0000, 模式: short
2025-04-27 23:08:33.067 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62377.0000, 当前价: 62440.2000
2025-04-27 23:08:38.677 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63336.9000, 模式: short
2025-04-27 23:08:38.752 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63336.9000, 当前价: 63250.0000
2025-04-27 23:08:38.783 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63402.9000, 模式: short
2025-04-27 23:08:41.749 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 63402.9000, 当前价: 60181.9000
2025-04-27 23:08:42.274 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60392.3000, 模式: short
2025-04-27 23:08:43.274 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60392.3000, 当前价: 60461.2000
2025-04-27 23:08:43.819 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60588.0000, 模式: short
2025-04-27 23:08:43.847 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60588.0000, 当前价: 60497.0000
2025-04-27 23:08:50.647 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57896.6000, 模式: short
2025-04-27 23:08:50.998 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57896.6000, 当前价: 57806.7000
2025-04-27 23:08:51.598 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 57355.0000, 模式: short
2025-04-27 23:08:51.614 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57355.0000, 当前价: 57462.8000
2025-04-27 23:08:53.381 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57643.3000, 模式: short
2025-04-27 23:09:01.798 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 57643.3000, 当前价: 60526.0000
2025-04-27 23:09:06.040 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62768.8000, 模式: short
2025-04-27 23:09:06.238 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62768.8000, 当前价: 63056.2000
2025-04-27 23:09:14.293 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63773.0000, 模式: short
2025-04-27 23:09:15.039 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63773.0000, 当前价: 63847.3000
2025-04-27 23:09:17.967 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63764.0000, 模式: short
2025-04-27 23:09:17.997 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63764.0000, 当前价: 63848.3000
2025-04-27 23:09:18.201 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63759.0000, 模式: short
2025-04-27 23:09:18.290 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63759.0000, 当前价: 63824.1000
2025-04-27 23:09:20.643 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 64229.1000, 模式: short
2025-04-27 23:09:20.676 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64229.1000, 当前价: 64319.9000
2025-04-27 23:09:23.776 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63232.8000, 模式: short
2025-04-27 23:09:23.791 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63232.8000, 当前价: 63428.1000
2025-04-27 23:09:26.869 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63399.2000, 模式: short
2025-04-27 23:09:26.884 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63399.2000, 当前价: 63573.2000
2025-04-27 23:09:27.571 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63763.5000, 模式: short
2025-04-27 23:09:27.605 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63763.5000, 当前价: 63898.8000
2025-04-27 23:09:31.503 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63040.3000, 模式: short
2025-04-27 23:09:45.699 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63040.3000, 当前价: 63196.6000
2025-04-27 23:09:46.660 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62724.8000, 模式: short
2025-04-27 23:09:50.284 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62724.8000, 当前价: 62478.9000
2025-04-27 23:09:50.936 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60820.0000, 模式: short
2025-04-27 23:09:50.951 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60820.0000, 当前价: 60725.5000
2025-04-27 23:09:54.593 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60739.5000, 模式: short
2025-04-27 23:09:56.365 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60739.5000, 当前价: 60678.6000
2025-04-27 23:09:59.620 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60867.5000, 模式: short
2025-04-27 23:10:00.033 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60867.5000, 当前价: 60796.1000
2025-04-27 23:10:01.177 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60861.4000, 模式: short
2025-04-27 23:10:02.260 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60861.4000, 当前价: 60760.1000
2025-04-27 23:10:06.129 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61347.0000, 模式: short
2025-04-27 23:10:06.158 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61347.0000, 当前价: 61255.5000
2025-04-27 23:10:08.662 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60937.1000, 模式: short
2025-04-27 23:10:08.856 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60937.1000, 当前价: 61071.3000
2025-04-27 23:10:14.527 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62855.7000, 模式: short
2025-04-27 23:10:14.545 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62855.7000, 当前价: 62689.4000
2025-04-27 23:10:15.081 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62540.4000, 模式: short
2025-04-27 23:10:15.306 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62540.4000, 当前价: 62645.9000
2025-04-27 23:10:20.347 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61645.0000, 模式: short
2025-04-27 23:10:20.377 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61645.0000, 当前价: 61730.6000
2025-04-27 23:10:21.928 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61819.4000, 模式: short
2025-04-27 23:10:21.988 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61819.4000, 当前价: 61895.9000
2025-04-27 23:10:22.262 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61868.3000, 模式: short
2025-04-27 23:10:22.307 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61868.3000, 当前价: 61804.5000
2025-04-27 23:10:22.879 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61865.9000, 模式: short
2025-04-27 23:10:22.981 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61865.9000, 当前价: 61797.6000
2025-04-27 23:10:23.704 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 62084.2000, 模式: short
2025-04-27 23:10:23.720 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62084.2000, 当前价: 62015.1000
2025-04-27 23:10:27.071 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 65790.9000, 模式: short
2025-04-27 23:10:29.811 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 65790.9000, 当前价: 65648.9000
2025-04-27 23:10:30.813 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66248.3000, 模式: short
2025-04-27 23:10:30.943 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66248.3000, 当前价: 66316.0000
2025-04-27 23:10:30.975 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66191.6000, 模式: short
2025-04-27 23:10:31.115 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66191.6000, 当前价: 66122.4000
2025-04-27 23:10:31.703 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66180.9000, 模式: short
2025-04-27 23:10:31.737 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66180.9000, 当前价: 65968.2000
2025-04-27 23:10:35.058 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 65264.1000, 模式: short
2025-04-27 23:10:35.131 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 65264.1000, 当前价: 65379.2000
2025-04-27 23:10:37.759 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66122.2000, 模式: short
2025-04-27 23:10:39.014 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66122.2000, 当前价: 65919.9000
2025-04-27 23:10:43.261 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66911.0000, 模式: short
2025-04-27 23:10:43.469 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66911.0000, 当前价: 66824.1000
2025-04-27 23:10:45.277 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67211.7000, 模式: short
2025-04-27 23:10:45.308 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67211.7000, 当前价: 67302.2000
2025-04-27 23:10:48.513 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66824.1000, 模式: short
2025-04-27 23:10:52.932 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66824.1000, 当前价: 66724.9000
2025-04-27 23:10:55.225 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66212.9000, 模式: short
2025-04-27 23:10:55.482 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66212.9000, 当前价: 66286.3000
2025-04-27 23:10:56.058 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66297.0000, 模式: short
2025-04-27 23:10:56.353 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66297.0000, 当前价: 66390.2000
2025-04-27 23:10:57.388 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66639.1000, 模式: short
2025-04-27 23:10:58.116 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66639.1000, 当前价: 66431.8000
2025-04-27 23:11:00.077 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66894.9000, 模式: short
2025-04-27 23:11:00.107 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66894.9000, 当前价: 66800.0000
2025-04-27 23:11:00.152 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67036.7000, 模式: short
2025-04-27 23:11:00.580 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67036.7000, 当前价: 67117.8000
2025-04-27 23:11:06.007 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 71071.5000, 模式: short
2025-04-27 23:11:06.318 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71071.5000, 当前价: 71200.1000
2025-04-27 23:11:07.020 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71219.9000, 模式: short
2025-04-27 23:11:07.214 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71219.9000, 当前价: 71050.1000
2025-04-27 23:11:10.495 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 70180.5000, 模式: short
2025-04-27 23:11:10.804 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70180.5000, 当前价: 70087.6000
2025-04-27 23:11:12.608 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 69865.4000, 模式: short
2025-04-27 23:11:12.640 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69865.4000, 当前价: 69959.3000
2025-04-27 23:11:18.736 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 69522.9000, 模式: short
2025-04-27 23:11:18.796 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69522.9000, 当前价: 69430.1000
2025-04-27 23:11:19.174 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 69456.1000, 模式: short
2025-04-27 23:11:21.035 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69456.1000, 当前价: 69308.4000
2025-04-27 23:11:25.613 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67901.6000, 模式: short
2025-04-27 23:11:28.672 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67901.6000, 当前价: 67982.8000
2025-04-27 23:11:31.876 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 68661.1000, 模式: short
2025-04-27 23:11:45.276 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 68661.1000, 当前价: 68364.4000
2025-04-27 23:11:48.237 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 68527.9000, 模式: short
2025-04-27 23:11:48.341 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 68527.9000, 当前价: 68722.2000
2025-04-27 23:11:51.545 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 70258.0000, 模式: short
2025-04-27 23:12:50.107 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70258.0000, 当前价: 70355.8000
2025-04-27 23:12:52.801 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 70683.8000, 模式: short
2025-04-27 23:12:52.862 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70683.8000, 当前价: 70888.2000
2025-04-27 23:12:54.712 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 70952.4000, 模式: short
2025-04-27 23:12:55.862 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70952.4000, 当前价: 70859.6000
2025-04-27 23:12:56.095 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 70818.9000, 模式: short
2025-04-27 23:12:56.520 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70818.9000, 当前价: 70727.3000
2025-04-27 23:12:59.639 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71191.1000, 模式: short
2025-04-27 23:12:59.819 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71191.1000, 当前价: 70885.1000
2025-04-27 23:13:00.155 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71115.1000, 模式: short
2025-04-27 23:13:00.229 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71115.1000, 当前价: 71011.1000
2025-04-27 23:13:00.888 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 71223.6000, 模式: short
2025-04-27 23:13:03.733 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71223.6000, 当前价: 71382.6000
2025-04-27 23:13:06.767 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 70859.6000, 模式: short
2025-04-27 23:13:06.906 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 70859.6000, 当前价: 70938.1000
2025-04-27 23:13:09.323 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71262.9000, 模式: short
2025-04-27 23:13:09.510 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71262.9000, 当前价: 71162.9000
2025-04-27 23:13:09.793 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71128.5000, 模式: short
2025-04-27 23:13:11.033 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71128.5000, 当前价: 71002.0000
2025-04-27 23:13:12.226 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 71102.7000, 模式: short
2025-04-27 23:13:12.288 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 71102.7000, 当前价: 70910.0000
2025-04-27 23:13:17.431 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 69486.9000, 模式: short
2025-04-27 23:13:25.682 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69486.9000, 当前价: 69563.4000
2025-04-27 23:13:28.589 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 69649.6000, 模式: short
2025-04-27 23:13:29.396 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69649.6000, 当前价: 69577.9000
2025-04-27 23:13:33.153 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 69470.0000, 模式: short
2025-04-27 23:13:33.170 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69470.0000, 当前价: 69556.3000
2025-04-27 23:13:33.883 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 69366.0000, 模式: short
2025-04-27 23:13:37.847 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 69366.0000, 当前价: 68989.0000
2025-04-27 23:13:38.541 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 68320.7000, 模式: short
2025-04-27 23:13:38.557 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 68320.7000, 当前价: 68228.2000
2025-04-27 23:13:39.660 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 67676.7000, 模式: short
2025-04-27 23:13:39.740 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67676.7000, 当前价: 67552.2000
2025-04-27 23:13:41.133 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67086.5000, 模式: short
2025-04-27 23:13:41.166 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67086.5000, 当前价: 67190.1000
2025-04-27 23:13:44.047 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 67226.1000, 模式: short
2025-04-27 23:13:45.236 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67226.1000, 当前价: 67125.2000
2025-04-27 23:13:46.936 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 67300.0000, 模式: short
2025-04-27 23:13:53.523 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67300.0000, 当前价: 67012.6000
2025-04-27 23:13:54.597 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 67432.6000, 模式: short
2025-04-27 23:13:55.344 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67432.6000, 当前价: 67336.5000
2025-04-27 23:13:56.207 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67814.5000, 模式: short
2025-04-27 23:13:56.298 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67814.5000, 当前价: 68337.2000
2025-04-27 23:13:57.998 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66803.3000, 模式: short
2025-04-27 23:13:58.180 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66803.3000, 当前价: 66708.3000
2025-04-27 23:13:59.850 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66875.9000, 模式: short
2025-04-27 23:14:00.751 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66875.9000, 当前价: 67008.0000
2025-04-27 23:14:01.223 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66795.4000, 模式: short
2025-04-27 23:14:01.576 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66795.4000, 当前价: 66907.2000
2025-04-27 23:14:01.964 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 67010.2000, 模式: short
2025-04-27 23:14:02.401 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 67010.2000, 当前价: 67120.8000
2025-04-27 23:14:09.064 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66246.5000, 模式: short
2025-04-27 23:14:09.433 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66246.5000, 当前价: 66168.4000
2025-04-27 23:14:11.794 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 66291.9000, 模式: short
2025-04-27 23:14:12.271 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66291.9000, 当前价: 66403.9000
2025-04-27 23:14:14.640 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66059.1000, 模式: short
2025-04-27 23:14:25.073 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66059.1000, 当前价: 65934.4000
2025-04-27 23:14:30.184 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 66539.7000, 模式: short
2025-04-27 23:14:30.280 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 66539.7000, 当前价: 66456.6000
2025-04-27 23:14:40.710 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 65480.2000, 模式: short
2025-04-27 23:14:40.801 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 65480.2000, 当前价: 65554.9000
2025-04-27 23:14:45.898 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64936.5000, 模式: short
2025-04-27 23:14:46.067 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64936.5000, 当前价: 64818.1000
2025-04-27 23:14:46.448 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64858.5000, 模式: short
2025-04-27 23:14:51.048 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64858.5000, 当前价: 64770.9000
2025-04-27 23:14:52.950 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 65032.9000, 模式: short
2025-04-27 23:14:52.985 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 65032.9000, 当前价: 65158.0000
2025-04-27 23:14:55.895 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64564.3000, 模式: short
2025-04-27 23:14:55.975 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64564.3000, 当前价: 64492.3000
2025-04-27 23:14:56.511 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 64614.2000, 模式: short
2025-04-27 23:14:56.606 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64614.2000, 当前价: 64691.0000
2025-04-27 23:14:57.901 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63926.5000, 模式: short
2025-04-27 23:14:57.983 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63926.5000, 当前价: 63860.2000
2025-04-27 23:14:58.636 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63835.5000, 模式: short
2025-04-27 23:14:58.863 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63835.5000, 当前价: 63909.4000
2025-04-27 23:15:01.781 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64112.0000, 模式: short
2025-04-27 23:15:02.171 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64112.0000, 当前价: 64035.8000
2025-04-27 23:15:03.758 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 64299.5000, 模式: short
2025-04-27 23:15:03.846 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64299.5000, 当前价: 64368.7000
2025-04-27 23:15:04.262 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64379.6000, 模式: short
2025-04-27 23:15:04.372 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64379.6000, 当前价: 64297.7000
2025-04-27 23:15:04.639 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64363.3000, 模式: short
2025-04-27 23:15:04.702 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64363.3000, 当前价: 64287.9000
2025-04-27 23:15:05.640 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64271.2000, 模式: short
2025-04-27 23:15:08.447 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64271.2000, 当前价: 64203.5000
2025-04-27 23:15:08.657 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 64234.0000, 模式: short
2025-04-27 23:15:14.622 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 64234.0000, 当前价: 64160.0000
2025-04-27 23:15:15.905 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 64120.2000, 模式: short
2025-04-27 23:15:21.002 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 64120.2000, 当前价: 60900.2000
2025-04-27 23:15:28.691 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61262.8000, 模式: short
2025-04-27 23:15:28.724 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61262.8000, 当前价: 61187.4000
2025-04-27 23:15:29.513 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61095.8000, 模式: short
2025-04-27 23:15:38.524 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61095.8000, 当前价: 60927.2000
2025-04-27 23:15:40.131 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 60982.1000, 模式: short
2025-04-27 23:15:40.326 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60982.1000, 当前价: 60906.6000
2025-04-27 23:15:42.104 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61041.6000, 模式: short
2025-04-27 23:15:42.152 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61041.6000, 当前价: 61184.1000
2025-04-27 23:15:45.874 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61714.9000, 模式: short
2025-04-27 23:15:46.031 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61714.9000, 当前价: 61792.3000
2025-04-27 23:15:46.468 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61879.9000, 模式: short
2025-04-27 23:15:48.562 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61879.9000, 当前价: 62055.6000
2025-04-27 23:15:50.034 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61616.4000, 模式: short
2025-04-27 23:15:51.653 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61616.4000, 当前价: 61681.9000
2025-04-27 23:15:51.994 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61588.4000, 模式: short
2025-04-27 23:15:52.062 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61588.4000, 当前价: 61476.8000
2025-04-27 23:15:54.653 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60292.0000, 模式: short
2025-04-27 23:15:54.859 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60292.0000, 当前价: 60359.7000
2025-04-27 23:15:56.752 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60772.6000, 模式: short
2025-04-27 23:15:57.639 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60772.6000, 当前价: 60838.1000
2025-04-27 23:15:58.736 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60957.1000, 模式: short
2025-04-27 23:15:58.768 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60957.1000, 当前价: 61025.3000
2025-04-27 23:16:02.105 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 61064.6000, 模式: short
2025-04-27 23:16:05.166 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61064.6000, 当前价: 61200.0000
2025-04-27 23:16:05.695 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 61455.1000, 模式: short
2025-04-27 23:16:06.979 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 61455.1000, 当前价: 61370.2000
2025-04-27 23:16:11.887 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 63356.4000, 模式: short
2025-04-27 23:16:12.048 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 63356.4000, 当前价: 63268.9000
2025-04-27 23:16:13.930 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62911.9000, 模式: short
2025-04-27 23:16:15.373 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62911.9000, 当前价: 62976.2000
2025-04-27 23:16:18.585 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62915.4000, 模式: short
2025-04-27 23:16:18.792 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62915.4000, 当前价: 63025.5000
2025-04-27 23:16:19.988 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 63020.1000, 模式: short
2025-04-27 23:16:31.783 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 63020.1000, 当前价: 59826.7000
2025-04-27 23:16:33.141 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 60305.3000, 模式: short
2025-04-27 23:16:33.174 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 60305.3000, 当前价: 60372.3000
2025-04-27 23:16:34.892 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 58870.7000, 模式: short
2025-04-27 23:16:35.059 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 58870.7000, 当前价: 58753.8000
2025-04-27 23:16:47.672 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 56659.8000, 模式: short
2025-04-27 23:16:47.734 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 56659.8000, 当前价: 56733.7000
2025-04-27 23:16:49.019 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 56319.0000, 模式: short
2025-04-27 23:16:49.310 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 56319.0000, 当前价: 56255.7000
2025-04-27 23:17:00.535 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 56920.6000, 模式: short
2025-04-27 23:17:00.734 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 56920.6000, 当前价: 57019.9000
2025-04-27 23:17:01.503 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 57178.0000, 模式: short
2025-04-27 23:17:01.958 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57178.0000, 当前价: 57252.2000
2025-04-27 23:17:03.939 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 54613.8000, 模式: short
2025-04-27 23:17:06.191 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 54613.8000, 当前价: 57831.1000
2025-04-27 23:17:09.013 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 55895.0000, 模式: short
2025-04-27 23:17:09.046 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 55895.0000, 当前价: 55955.0000
2025-04-27 23:17:12.841 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57179.3000, 模式: short
2025-04-27 23:17:13.705 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57179.3000, 当前价: 57114.9000
2025-04-27 23:17:17.784 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57747.1000, 模式: short
2025-04-27 23:17:19.204 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57747.1000, 当前价: 57642.8000
2025-04-27 23:17:25.323 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57601.8000, 模式: short
2025-04-27 23:17:25.357 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57601.8000, 当前价: 57544.0000
2025-04-27 23:17:33.493 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57742.2000, 模式: short
2025-04-27 23:17:33.724 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57742.2000, 当前价: 57680.3000
2025-04-27 23:17:34.662 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 57500.0000, 模式: short
2025-04-27 23:17:39.924 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57500.0000, 当前价: 57627.4000
2025-04-27 23:17:40.552 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 57827.2000, 模式: short
2025-04-27 23:17:42.061 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57827.2000, 当前价: 57723.1000
2025-04-27 23:17:44.883 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 57875.5000, 模式: short
2025-04-27 23:17:45.599 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 57875.5000, 当前价: 58018.2000
2025-04-27 23:17:46.050 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 58064.4000, 模式: short
2025-04-27 23:17:46.319 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 58064.4000, 当前价: 58140.0000
2025-04-27 23:17:50.566 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 58602.9000, 模式: short
2025-04-27 23:17:50.997 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 58602.9000, 当前价: 58668.8000
2025-04-27 23:17:56.949 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 59717.2000, 模式: short
2025-04-27 23:17:57.032 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 59717.2000, 当前价: 59860.0000
2025-04-27 23:17:57.679 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 59974.7000, 模式: short
2025-04-27 23:17:57.749 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 59974.7000, 当前价: 60054.9000
2025-04-27 23:17:58.222 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 59906.8000, 模式: short
2025-04-27 23:18:02.629 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止损 (5.00%). 原模式: short, 入场价: 59906.8000, 当前价: 62936.0000
2025-04-27 23:18:02.934 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 62900.0000, 模式: short
2025-04-27 23:18:02.969 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 62900.0000, 当前价: 62966.0000
2025-04-27 23:27:00.149 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:27:01.839 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:27:01.840 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:27:01.840 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:27:01.841 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:27:01.842 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:27:01.843 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:27:01.843 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:27:01.844 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:27:01.844 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:27:01.845 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:27:01.848 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:27:03.311 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:27:03.312 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:27:03.312 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:27:03.312 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:27:03.316 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:27:03.316 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:27:03.316 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2024-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:27:07.540 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:27:09.061 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:27:09.061 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:27:09.062 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:27:09.063 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:27:09.064 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:27:09.064 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:27:09.064 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:27:09.065 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:27:09.065 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:27:09.066 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:27:09.070 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:27:10.307 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:27:10.307 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:27:10.308 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:27:10.308 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:27:10.311 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:27:10.312 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:27:10.312 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:27:14.130 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:27:14.131 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:27:14.132 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:27:14.132 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:27:27.819 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 13.69 秒。
2025-04-27 23:27:27.820 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:27:27.825 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:27:28.453 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:27:28.455 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:27:28.459 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:27:28.459 | WARNING  | MainThread      | backtest.results:calculate_metrics:234 | 交易记录为空或格式不正确，无法计算交易相关指标。
2025-04-27 23:27:28.460 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:27:28.460 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:27:28.712 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:27:28.712 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 19.65 秒。
2025-04-27 23:27:28.713 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:27:28.713 | WARNING  | MainThread      | backtest.results:generate_report_html:268 | 收益率序列为空、全为零或数据点过少，无法生成 quantstats 报告。
2025-04-27 23:27:28.714 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:28:01.220 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:28:02.861 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:28:02.861 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:28:02.863 | INFO     | MainThread      | strategies.mystrategy:__init__:101 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:28:02.863 | INFO     | MainThread      | strategies.mystrategy:__init__:102 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=8e-05/0.00012
2025-04-27 23:28:02.863 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:28:02.863 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:28:02.865 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:28:02.865 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:28:02.866 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:28:02.867 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:28:02.867 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:28:02.867 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:28:02.871 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:28:04.177 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:28:04.177 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:28:04.178 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:28:04.178 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:28:04.182 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:28:04.182 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:28:04.183 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:28:07.923 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:28:07.924 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:28:07.925 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:28:07.926 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:28:07.989 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:28:08.047 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83229.4000, 当前价: 82776.0000
2025-04-27 23:28:08.240 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:28:08.251 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83390.5000, 当前价: 83479.8000
2025-04-27 23:28:08.328 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:28:08.380 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83543.6000, 当前价: 83966.9000
2025-04-27 23:28:09.229 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:28:09.314 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:28:09.368 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:28:09.399 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:28:10.155 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:28:10.159 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:28:10.835 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:28:10.891 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 83255.8000, 当前价: 83719.5000
2025-04-27 23:28:14.224 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:28:14.229 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:28:14.280 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:28:14.291 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 23:28:15.597 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:28:15.608 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:28:16.121 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:28:16.161 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 84263.6000, 当前价: 84690.9000
2025-04-27 23:28:16.931 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:28:17.027 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:28:17.101 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:28:17.152 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84820.9000, 当前价: 84725.0000
2025-04-27 23:28:17.194 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 23:28:17.201 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 23:28:17.392 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:28:17.406 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:28:17.618 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:28:17.850 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84506.0000, 当前价: 84418.2000
2025-04-27 23:28:18.056 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:28:18.066 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 23:28:18.223 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:28:18.423 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:28:18.494 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:28:18.703 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止损 (0.50%). 原模式: short, 入场价: 84342.9000, 当前价: 84770.9000
2025-04-27 23:28:19.512 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:604 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85307.8000, 模式: short
2025-04-27 23:28:19.539 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:441 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.10%). 原模式: short, 入场价: 85307.8000, 当前价: 85156.8000
2025-04-27 23:28:20.074 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 12.15 秒。
2025-04-27 23:28:20.074 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:28:20.081 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:28:20.704 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:28:20.706 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:28:20.708 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:28:20.710 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:28:20.710 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:28:20.962 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:28:20.962 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 18.10 秒。
2025-04-27 23:28:20.963 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:28:20.964 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:28:20.964 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_232820_964.html
2025-04-27 23:28:22.144 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_232820_964.html
2025-04-27 23:28:22.145 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:29:23.508 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:29:25.155 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:29:25.155 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:29:25.155 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:29:25.156 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:29:25.156 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:29:25.156 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:29:25.157 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:29:25.158 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:29:25.158 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:29:25.159 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:29:25.160 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:29:25.160 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:29:25.164 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:29:26.313 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:29:26.313 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:29:26.313 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:29:26.314 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:29:26.318 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:29:26.319 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:29:26.319 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:29:29.944 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:29:29.945 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:29:29.946 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:29:29.947 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:29:29.995 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:29:30.154 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:29:30.204 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:29:30.222 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 23:29:30.279 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:29:30.393 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 23:29:31.068 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:29:31.144 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:29:31.185 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:29:31.211 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:29:31.892 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:29:31.896 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:29:32.504 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:29:35.438 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 23:29:35.716 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:29:35.720 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:29:35.765 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:29:35.801 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 23:29:36.949 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:29:36.960 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:29:37.396 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:29:37.563 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:29:38.110 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:29:38.194 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:29:38.260 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:29:38.342 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 23:29:38.512 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:29:38.525 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:29:38.705 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:29:38.915 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 23:29:39.089 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:29:39.124 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 23:29:39.237 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:29:39.428 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:29:39.483 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:29:40.852 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.91 秒。
2025-04-27 23:29:40.852 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:29:40.859 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:29:41.497 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:29:41.498 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:29:41.501 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:29:41.503 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:29:41.503 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:29:41.747 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:29:41.747 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.59 秒。
2025-04-27 23:29:41.748 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:29:41.748 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:29:41.749 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_232941_749.html
2025-04-27 23:29:43.005 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_232941_749.html
2025-04-27 23:29:43.006 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:31:14.923 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:31:16.462 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:31:16.463 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:31:16.463 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:31:16.463 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:31:16.463 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:31:16.463 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:31:16.465 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:31:16.465 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:31:16.466 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:31:16.467 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:31:16.467 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:31:16.467 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:31:16.471 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:31:17.769 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:31:17.769 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:31:17.769 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:31:17.770 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:31:17.773 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:31:17.773 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:31:17.773 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:31:21.467 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:31:21.468 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:31:21.470 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:31:21.470 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:31:21.514 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:31:21.682 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:31:21.745 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:31:21.766 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 23:31:21.824 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:31:21.932 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 23:31:22.591 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:31:22.660 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:31:22.703 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:31:22.730 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:31:23.363 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:31:23.367 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:31:23.929 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:31:26.661 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83255.8000, 当前价: 83147.2000
2025-04-27 23:31:26.902 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:31:26.905 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:31:26.950 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:31:26.985 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83463.6000, 当前价: 83646.8000
2025-04-27 23:31:28.135 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:31:28.145 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84112.9000, 当前价: 83903.0000
2025-04-27 23:31:28.582 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:31:28.743 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:31:29.297 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:31:29.384 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84923.6000, 当前价: 85074.4000
2025-04-27 23:31:29.450 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:31:29.541 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84820.9000, 当前价: 84719.1000
2025-04-27 23:31:29.711 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:31:29.723 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84624.0000, 当前价: 84408.6000
2025-04-27 23:31:29.912 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:31:30.140 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84506.0000, 当前价: 84376.2000
2025-04-27 23:31:30.322 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:31:30.364 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84448.9000, 当前价: 84557.9000
2025-04-27 23:31:30.506 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:31:30.677 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84442.5000, 当前价: 84318.2000
2025-04-27 23:31:30.733 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:31:32.124 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.65 秒。
2025-04-27 23:31:32.125 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:31:32.131 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:31:32.786 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:31:32.788 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:31:32.791 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:31:32.792 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:31:32.792 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:31:33.044 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:31:33.044 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.58 秒。
2025-04-27 23:31:33.045 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:31:33.046 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:31:33.046 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233133_046.html
2025-04-27 23:31:34.323 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233133_046.html
2025-04-27 23:31:34.324 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:32:06.622 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:32:08.143 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:32:08.144 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:32:08.144 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:32:08.144 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:32:08.144 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:32:08.144 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:32:08.147 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:32:08.147 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:32:08.147 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:32:08.148 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:32:08.148 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:32:08.149 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:32:08.153 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:32:09.434 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:32:09.434 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:32:09.435 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:32:09.435 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:32:09.439 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:32:09.439 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:32:09.439 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:32:12.835 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:32:12.836 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:32:12.837 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:32:12.837 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:32:12.879 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:32:13.182 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.60%). 原模式: short, 入场价: 83229.4000, 当前价: 83779.1000
2025-04-27 23:32:13.910 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:32:14.155 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.60%). 原模式: short, 入场价: 85327.6000, 当前价: 84793.6000
2025-04-27 23:32:14.671 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:32:14.748 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.60%). 原模式: short, 入场价: 84354.6000, 当前价: 83724.7000
2025-04-27 23:32:15.245 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:32:23.181 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.34 秒。
2025-04-27 23:32:23.181 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:32:23.187 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:32:23.837 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:32:23.839 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:32:23.842 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:32:23.844 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:32:23.844 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:32:24.095 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:32:24.095 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 15.95 秒。
2025-04-27 23:32:24.096 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:32:24.097 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:32:24.097 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233224_097.html
2025-04-27 23:32:25.295 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233224_097.html
2025-04-27 23:32:25.297 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:32:42.883 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:32:44.407 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:32:44.407 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:32:44.407 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:32:44.407 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:32:44.408 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:32:44.408 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:32:44.410 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:32:44.410 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:32:44.411 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:32:44.411 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:32:44.412 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:32:44.412 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:32:44.415 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:32:45.893 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:32:45.894 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:32:45.894 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:32:45.894 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:32:45.898 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:32:45.898 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:32:45.898 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:32:49.536 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:32:49.537 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:32:49.538 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:32:49.538 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:32:49.583 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:32:49.735 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83229.4000, 当前价: 83284.7000
2025-04-27 23:32:49.791 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:32:49.795 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83390.5000, 当前价: 83441.7000
2025-04-27 23:32:49.864 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:32:49.921 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83543.6000, 当前价: 83487.3000
2025-04-27 23:32:50.635 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:32:50.638 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85327.6000, 当前价: 85255.6000
2025-04-27 23:32:50.749 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:32:50.771 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85247.2000, 当前价: 85185.8000
2025-04-27 23:32:51.405 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:32:51.409 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:32:51.991 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:32:54.662 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83255.8000, 当前价: 83182.9000
2025-04-27 23:32:54.930 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:32:54.933 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:32:54.976 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:32:54.986 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 23:32:56.106 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:32:56.114 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84112.9000, 当前价: 84047.7000
2025-04-27 23:32:56.550 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:32:56.708 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:32:57.241 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:32:57.246 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84923.6000, 当前价: 84984.8000
2025-04-27 23:32:57.260 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84863.6000, 模式: short
2025-04-27 23:32:57.278 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84863.6000, 当前价: 84807.6000
2025-04-27 23:32:57.392 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:32:57.419 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84820.9000, 当前价: 84745.3000
2025-04-27 23:32:57.478 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 23:32:57.484 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 23:32:57.642 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:32:57.647 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84624.0000, 当前价: 84569.3000
2025-04-27 23:32:57.835 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:32:57.864 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84506.0000, 当前价: 84454.4000
2025-04-27 23:32:57.871 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84561.4000, 模式: short
2025-04-27 23:32:57.918 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84561.4000, 当前价: 84645.3000
2025-04-27 23:32:58.221 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:32:58.230 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 23:32:58.372 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:32:58.544 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84442.5000, 当前价: 84388.0000
2025-04-27 23:32:58.599 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:32:59.915 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.38 秒。
2025-04-27 23:32:59.916 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:32:59.922 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:33:00.543 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:33:00.545 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:33:00.548 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:33:00.550 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:33:00.550 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:33:00.799 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:33:00.799 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 16.39 秒。
2025-04-27 23:33:00.800 | INFO     | MainThread      | __main__:main:205 | 生成回测报告...
2025-04-27 23:33:00.801 | INFO     | MainThread      | backtest.results:generate_report_html:277 | 将使用收益率序列生成 QuantStats 报告。交易细节图表可能不包含在内，除非适配 trades 数据格式。
2025-04-27 23:33:00.802 | INFO     | MainThread      | backtest.results:generate_report_html:292 | 准备生成 QuantStats HTML 报告: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233300_802.html
2025-04-27 23:33:02.048 | INFO     | MainThread      | backtest.results:generate_report_html:302 | 回测报告已生成: C:\Users\qingf\Documents\lianghua\trader\future_trade\backtest_reports\MyStrategy_回测报告_20250427_233300_802.html
2025-04-27 23:33:02.049 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:34:05.131 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:34:06.710 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:34:06.710 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:34:06.710 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:34:06.711 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:34:06.711 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:34:06.711 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:34:06.712 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:34:06.713 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:34:06.713 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:34:06.714 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:34:06.714 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:34:06.714 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:34:06.718 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:34:08.471 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:34:08.471 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:34:08.472 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:34:08.472 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:34:08.475 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:34:08.475 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:34:08.476 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:34:12.111 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:34:12.113 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:34:12.114 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:34:12.114 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:34:12.161 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:34:12.311 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83229.4000, 当前价: 83284.7000
2025-04-27 23:34:12.376 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:34:12.381 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83390.5000, 当前价: 83441.7000
2025-04-27 23:34:12.459 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:34:12.525 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83543.6000, 当前价: 83487.3000
2025-04-27 23:34:13.287 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:34:13.291 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85327.6000, 当前价: 85255.6000
2025-04-27 23:34:13.416 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:34:13.443 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85247.2000, 当前价: 85185.8000
2025-04-27 23:34:14.084 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:34:14.088 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:34:14.695 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:34:17.615 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83255.8000, 当前价: 83182.9000
2025-04-27 23:34:17.907 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83441.0000, 模式: short
2025-04-27 23:34:17.911 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83441.0000, 当前价: 83288.7000
2025-04-27 23:34:17.955 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83463.6000, 模式: short
2025-04-27 23:34:17.965 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83463.6000, 当前价: 83558.5000
2025-04-27 23:34:19.192 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84112.9000, 模式: short
2025-04-27 23:34:19.199 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84112.9000, 当前价: 84047.7000
2025-04-27 23:34:19.632 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84263.6000, 模式: short
2025-04-27 23:34:19.794 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84263.6000, 当前价: 84109.6000
2025-04-27 23:34:20.335 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84923.6000, 模式: short
2025-04-27 23:34:20.340 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84923.6000, 当前价: 84984.8000
2025-04-27 23:34:20.354 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84863.6000, 模式: short
2025-04-27 23:34:20.372 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84863.6000, 当前价: 84807.6000
2025-04-27 23:34:20.484 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84820.9000, 模式: short
2025-04-27 23:34:20.510 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84820.9000, 当前价: 84745.3000
2025-04-27 23:34:20.566 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84719.1000, 模式: short
2025-04-27 23:34:20.574 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84719.1000, 当前价: 84617.8000
2025-04-27 23:34:20.737 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84624.0000, 模式: short
2025-04-27 23:34:20.742 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84624.0000, 当前价: 84569.3000
2025-04-27 23:34:20.936 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84506.0000, 模式: short
2025-04-27 23:34:20.962 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84506.0000, 当前价: 84454.4000
2025-04-27 23:34:20.968 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84561.4000, 模式: short
2025-04-27 23:34:21.015 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84561.4000, 当前价: 84645.3000
2025-04-27 23:34:21.319 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 84448.9000, 模式: short
2025-04-27 23:34:21.328 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84448.9000, 当前价: 84547.0000
2025-04-27 23:34:21.477 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84442.5000, 模式: short
2025-04-27 23:34:21.647 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:400 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84442.5000, 当前价: 84388.0000
2025-04-27 23:34:21.703 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:563 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84342.9000, 模式: short
2025-04-27 23:34:23.071 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 10.96 秒。
2025-04-27 23:34:23.071 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:34:23.078 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.02 年，计算年化指标...
2025-04-27 23:34:23.718 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:34:23.719 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:34:23.722 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:34:23.723 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:34:23.723 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:34:23.990 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:34:23.990 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 17.28 秒。
2025-04-27 23:34:23.991 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:45:14.194 | INFO     | MainThread      | utils.logger:__init__:100 | 日志管理器初始化完成
2025-04-27 23:45:15.821 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:45:15.821 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:45:15.821 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:45:15.821 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:45:15.821 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:45:15.822 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:45:15.823 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:45:15.823 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:45:15.824 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:45:15.825 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:45:15.825 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:45:15.825 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:45:15.829 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:45:17.050 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:45:17.050 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:45:17.051 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:45:17.051 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:45:17.054 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:45:17.054 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:45:17.055 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:45:21.127 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:45:21.128 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:45:21.129 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:45:21.130 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:45:21.174 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:45:21.331 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83229.4000, 当前价: 83284.7000
2025-04-27 23:45:21.393 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:45:21.397 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83390.5000, 当前价: 83441.7000
2025-04-27 23:45:21.472 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:45:21.533 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 83543.6000, 当前价: 83487.3000
2025-04-27 23:45:22.224 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:45:22.228 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85327.6000, 当前价: 85255.6000
2025-04-27 23:45:22.339 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:45:22.363 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 85247.2000, 当前价: 85185.8000
2025-04-27 23:45:23.026 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:45:23.030 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.06%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:45:23.610 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:45:25.777 | ERROR    | MainThread      | backtest.engine:_run_event_loop:600 | [2025-04-15 13:45:00+00:00] 账户权益耗尽 (-2.61)！回测提前终止。
2025-04-27 23:45:25.777 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 4.65 秒。
2025-04-27 23:45:25.778 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:45:25.783 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 23:45:26.412 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:45:26.414 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:45:26.416 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:45:26.417 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:45:26.418 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:45:26.669 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:45:26.669 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 10.85 秒。
2025-04-27 23:45:26.670 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
2025-04-27 23:53:26.448 | INFO     | MainThread      | utils.logger:__init__:101 | 日志管理器初始化完成
2025-04-27 23:53:28.030 | DEBUG    | MainThread      | __main__:<module>:230 | Windows event loop policy set.
2025-04-27 23:53:28.032 | INFO     | MainThread      | __main__:main:150 | 使用的数据库路径: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:53:28.032 | INFO     | MainThread      | __main__:load_strategy:34 | 尝试从模块 strategies.mystrategy 加载策略类 MyStrategy...
2025-04-27 23:53:28.032 | INFO     | MainThread      | strategies.mystrategy:__init__:93 | 策略 'MACD_EMA_Vol_Categorized_Strategy_CN_Optimized' 已初始化。
2025-04-27 23:53:28.033 | INFO     | MainThread      | strategies.mystrategy:__init__:94 | 优化点: MACD柱阈值=1e-05, 交叉成交量确认因子=1.1, 中/长线EMA分离度=0.0001/0.00015
2025-04-27 23:53:28.033 | INFO     | MainThread      | __main__:load_strategy:41 | 成功加载并实例化策略: MyStrategy
2025-04-27 23:53:28.033 | INFO     | MainThread      | __main__:main:170 | 创建回测引擎...
2025-04-27 23:53:28.035 | INFO     | MainThread      | __main__:main:189 | 开始回测策略 'MyStrategy'...
2025-04-27 23:53:28.035 | INFO     | MainThread      | backtest.engine:_initialize_connections:127 | 初始化数据库连接...
2025-04-27 23:53:28.035 | INFO     | MainThread      | database.sqlite:_connect:39 | 数据库连接已建立: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db (check_same_thread=True)
2025-04-27 23:53:28.036 | INFO     | MainThread      | database.sqlite:_create_tables:183 | 数据库表结构检查/创建完成
2025-04-27 23:53:28.036 | INFO     | MainThread      | backtest.engine:_initialize_connections:142 | 初始化交易所接口 'xt' 用于获取缺失数据...
2025-04-27 23:53:28.037 | INFO     | MainThread      | trading.api:_create_exchange:83 | 为 XT 合约市场设置 options (尝试 type='future', subType='linear')
2025-04-27 23:53:28.040 | INFO     | MainThread      | trading.api:initialize:50 | 交易所 xt (future) 实例创建成功. 测试网: False
2025-04-27 23:53:29.231 | INFO     | MainThread      | trading.api:_load_markets:133 | 交易所 xt 的市场信息已加载
2025-04-27 23:53:29.232 | INFO     | MainThread      | trading.api:initialize:54 | 市场信息异步加载完成.
2025-04-27 23:53:29.232 | INFO     | MainThread      | backtest.engine:_initialize_connections:154 | 交易所接口初始化成功。
2025-04-27 23:53:29.232 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:405 | [BTC/USDT:USDT] 准备数据...
2025-04-27 23:53:29.236 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:427 | [BTC/USDT:USDT] 从数据库加载了 0 条 K 线数据。
2025-04-27 23:53:29.236 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:444 | [BTC/USDT:USDT] 数据库无数据，需要从交易所获取整个范围。
2025-04-27 23:53:29.237 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:177 | [BTC/USDT:USDT] 尝试从交易所获取 3m K线数据 (2025-04-12 00:00:00+00:00 to 2025-04-20 00:00:00+00:00)
2025-04-27 23:53:29.237 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:193 | [BTC/USDT:USDT] Fetching from 2025-04-12 00:00:00+00:00 limit 1000
2025-04-27 23:53:29.576 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:207 | [BTC/USDT:USDT] 获取到 1000 条原始 K 线数据
2025-04-27 23:53:30.077 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:193 | [BTC/USDT:USDT] Fetching from 2025-04-14 01:57:00.001000+00:00 limit 1000
2025-04-27 23:53:30.507 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:207 | [BTC/USDT:USDT] 获取到 999 条原始 K 线数据
2025-04-27 23:53:31.008 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:193 | [BTC/USDT:USDT] Fetching from 2025-04-16 03:54:00.001000+00:00 limit 1000
2025-04-27 23:53:31.401 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:207 | [BTC/USDT:USDT] 获取到 999 条原始 K 线数据
2025-04-27 23:53:31.902 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:193 | [BTC/USDT:USDT] Fetching from 2025-04-18 05:51:00.001000+00:00 limit 1000
2025-04-27 23:53:32.360 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:207 | [BTC/USDT:USDT] 获取到 999 条原始 K 线数据
2025-04-27 23:53:32.360 | DEBUG    | MainThread      | backtest.engine:_fetch_and_store_data:232 | [BTC/USDT:USDT] 已获取到或超过结束时间戳 1745107200000
2025-04-27 23:53:32.882 | INFO     | MainThread      | backtest.engine:_fetch_and_store_data:307 | [BTC/USDT:USDT] 成功将 3841 条获取到的 K 线存入数据库。
2025-04-27 23:53:32.884 | INFO     | MainThread      | backtest.engine:_load_and_fetch_symbol_data:490 | [BTC/USDT:USDT] 合并数据库与获取的数据后，共有 3841 条。
2025-04-27 23:53:32.885 | INFO     | MainThread      | backtest.engine:_prepare_data:390 | 数据准备完成。共 3841 行数据，覆盖 3841 个时间点。
2025-04-27 23:53:32.885 | DEBUG    | MainThread      | backtest.engine:_prepare_data:393 | 数据时间范围: 从 2025-04-12 00:00:00+00:00 到 2025-04-20 00:00:00+00:00
2025-04-27 23:53:32.886 | INFO     | MainThread      | backtest.engine:_run_event_loop:515 | 开始运行回测事件循环...
2025-04-27 23:53:32.909 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000072 > 1e-05, VolConf:True, EmaDiff:-0.0005
2025-04-27 23:53:32.924 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000068 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:32.933 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83229.4000, 模式: short
2025-04-27 23:53:32.934 | DEBUG    | MainThread      | backtest.engine:_handle_signal:700 | [2025-04-12 02:00:00+00:00|BTC/USDT:USDT] 信号: BUY. 开多仓 (Reason: 金叉-短线模式(优化))...
2025-04-27 23:53:32.934 | DEBUG    | MainThread      | backtest.engine:_handle_signal:751 | [2025-04-12 02:00:00+00:00|BTC/USDT:USDT] 多仓已开. Amount: 0.007209, Price: 83229.4000, Comm: 0.0288, Cash: 19.9712
2025-04-27 23:53:33.112 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83229.4000, 当前价: 83349.9000
2025-04-27 23:53:33.114 | DEBUG    | MainThread      | backtest.engine:_handle_signal:845 | [2025-04-12 05:03:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平多仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:33.114 | DEBUG    | MainThread      | backtest.engine:_handle_signal:865 | [2025-04-12 05:03:00+00:00|BTC/USDT:USDT] 多仓已平. PnL: 0.8687, Comm: 0.0288, Cash: 20.8110
2025-04-27 23:53:33.123 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000014 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.126 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000030 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.134 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000054 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.140 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000002 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.143 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000061 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.167 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 金叉-短线模式(优化) 信号触发 @ 83390.5000, 模式: short
2025-04-27 23:53:33.167 | DEBUG    | MainThread      | backtest.engine:_handle_signal:700 | [2025-04-12 06:00:00+00:00|BTC/USDT:USDT] 信号: BUY. 开多仓 (Reason: 金叉-短线模式(优化))...
2025-04-27 23:53:33.168 | DEBUG    | MainThread      | backtest.engine:_handle_signal:751 | [2025-04-12 06:00:00+00:00|BTC/USDT:USDT] 多仓已开. Amount: 0.007487, Price: 83390.5000, Comm: 0.0300, Cash: 20.7811
2025-04-27 23:53:33.187 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83390.5000, 当前价: 83502.6000
2025-04-27 23:53:33.188 | DEBUG    | MainThread      | backtest.engine:_handle_signal:845 | [2025-04-12 06:21:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平多仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:33.188 | DEBUG    | MainThread      | backtest.engine:_handle_signal:865 | [2025-04-12 06:21:00+00:00|BTC/USDT:USDT] 多仓已平. PnL: 0.8393, Comm: 0.0300, Cash: 21.5904
2025-04-27 23:53:33.209 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000004 (Thr:-1e-05), VolConf:True
2025-04-27 23:53:33.236 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000175 > 1e-05, VolConf:True, EmaDiff:0.0003
2025-04-27 23:53:33.244 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83543.6000, 模式: short
2025-04-27 23:53:33.245 | DEBUG    | MainThread      | backtest.engine:_handle_signal:785 | [2025-04-12 07:24:00+00:00|BTC/USDT:USDT] 信号: SELL. 开空仓 (Reason: 死叉-短线模式(空)(优化))...
2025-04-27 23:53:33.245 | DEBUG    | MainThread      | backtest.engine:_handle_signal:834 | [2025-04-12 07:24:00+00:00|BTC/USDT:USDT] 空仓已开. Amount: 0.007753, Price: 83543.6000, Comm: 0.0311, Cash: 21.5593
2025-04-27 23:53:33.358 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 83543.6000, 当前价: 83426.4000
2025-04-27 23:53:33.359 | DEBUG    | MainThread      | backtest.engine:_handle_signal:871 | [2025-04-12 09:27:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平空仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:33.359 | DEBUG    | MainThread      | backtest.engine:_handle_signal:891 | [2025-04-12 09:27:00+00:00|BTC/USDT:USDT] 空仓已平. PnL: 0.9087, Comm: 0.0310, Cash: 22.4369
2025-04-27 23:53:33.373 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000049 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.393 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000076 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.403 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000003 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.407 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000008 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.418 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000029 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.426 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000071 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.445 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000041 > 1e-05, VolConf:True, EmaDiff:-0.0004
2025-04-27 23:53:33.480 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000058 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.498 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000053 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.509 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000003 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.512 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000031 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.538 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000064 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.542 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000036 > 1e-05, VolConf:True, EmaDiff:0.0007
2025-04-27 23:53:33.549 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000184 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.561 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000026 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.577 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000236 < -1e-05, VolConf:True, EmaDiff:0.0004
2025-04-27 23:53:33.602 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000028 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.637 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000229 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.645 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000078 > 1e-05, VolConf:True, EmaDiff:0.0017
2025-04-27 23:53:33.661 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000338 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.696 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000312 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.720 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000079 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.751 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000172 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.759 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000104 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.786 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000105 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.794 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000076 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.808 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000107 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.839 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000032 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.844 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000153 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.875 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000035 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.880 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000030 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.900 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000122 < -1e-05, VolConf:True, EmaDiff:0.0007
2025-04-27 23:53:33.922 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000008 (Thr:1e-05), VolConf:False
2025-04-27 23:53:33.924 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000119 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:33.951 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000033 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.000 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000112 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.030 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000013 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.037 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000015 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.051 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000092 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.059 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85327.6000, 模式: short
2025-04-27 23:53:34.060 | DEBUG    | MainThread      | backtest.engine:_handle_signal:785 | [2025-04-12 21:51:00+00:00|BTC/USDT:USDT] 信号: SELL. 开空仓 (Reason: 死叉-短线模式(空)(优化))...
2025-04-27 23:53:34.061 | DEBUG    | MainThread      | backtest.engine:_handle_signal:834 | [2025-04-12 21:51:00+00:00|BTC/USDT:USDT] 空仓已开. Amount: 0.007888, Price: 85327.6000, Comm: 0.0323, Cash: 22.4046
2025-04-27 23:53:34.131 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85327.6000, 当前价: 85213.9000
2025-04-27 23:53:34.132 | DEBUG    | MainThread      | backtest.engine:_handle_signal:871 | [2025-04-12 23:12:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平空仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:34.133 | DEBUG    | MainThread      | backtest.engine:_handle_signal:891 | [2025-04-12 23:12:00+00:00|BTC/USDT:USDT] 空仓已平. PnL: 0.8969, Comm: 0.0323, Cash: 23.2692
2025-04-27 23:53:34.152 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000006 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.175 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 85247.2000, 模式: short
2025-04-27 23:53:34.176 | DEBUG    | MainThread      | backtest.engine:_handle_signal:785 | [2025-04-13 00:00:00+00:00|BTC/USDT:USDT] 信号: SELL. 开空仓 (Reason: 死叉-短线模式(空)(优化))...
2025-04-27 23:53:34.176 | DEBUG    | MainThread      | backtest.engine:_handle_signal:834 | [2025-04-13 00:00:00+00:00|BTC/USDT:USDT] 空仓已开. Amount: 0.008189, Price: 85247.2000, Comm: 0.0335, Cash: 23.2357
2025-04-27 23:53:34.201 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 85247.2000, 当前价: 85143.4000
2025-04-27 23:53:34.203 | DEBUG    | MainThread      | backtest.engine:_handle_signal:871 | [2025-04-13 00:27:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平空仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:34.203 | DEBUG    | MainThread      | backtest.engine:_handle_signal:891 | [2025-04-13 00:27:00+00:00|BTC/USDT:USDT] 空仓已平. PnL: 0.8500, Comm: 0.0335, Cash: 24.0522
2025-04-27 23:53:34.217 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000082 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.248 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000077 < -1e-05, VolConf:True, EmaDiff:0.0011
2025-04-27 23:53:34.253 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000067 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.259 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000222 < -1e-05, VolConf:True, EmaDiff:0.0008
2025-04-27 23:53:34.317 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000003 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.358 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000078 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.373 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000110 > 1e-05, VolConf:True, EmaDiff:0.0007
2025-04-27 23:53:34.393 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000168 < -1e-05, VolConf:True, EmaDiff:0.0006
2025-04-27 23:53:34.423 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000049 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.427 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000086 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.441 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000049 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.444 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000006 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.455 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000071 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.465 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000026 < -1e-05, VolConf:True, EmaDiff:-0.0012
2025-04-27 23:53:34.471 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000067 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.497 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000264 < -1e-05, VolConf:True, EmaDiff:-0.0005
2025-04-27 23:53:34.508 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000062 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.527 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000010 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.530 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000154 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.552 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000043 < -1e-05, VolConf:True, EmaDiff:0.0005
2025-04-27 23:53:34.570 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000031 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.585 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000040 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.643 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000189 > 1e-05, VolConf:True, EmaDiff:-0.0006
2025-04-27 23:53:34.699 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000123 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.714 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000053 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.739 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000046 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.742 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000029 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.751 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000052 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.780 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000004 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.815 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000260 < -1e-05, VolConf:True, EmaDiff:-0.0004
2025-04-27 23:53:34.836 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000042 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.880 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 84354.6000, 模式: short
2025-04-27 23:53:34.881 | DEBUG    | MainThread      | backtest.engine:_handle_signal:785 | [2025-04-13 12:21:00+00:00|BTC/USDT:USDT] 信号: SELL. 开空仓 (Reason: 死叉-短线模式(空)(优化))...
2025-04-27 23:53:34.881 | DEBUG    | MainThread      | backtest.engine:_handle_signal:834 | [2025-04-13 12:21:00+00:00|BTC/USDT:USDT] 空仓已开. Amount: 0.008554, Price: 84354.6000, Comm: 0.0346, Cash: 24.0176
2025-04-27 23:53:34.884 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:401 | [BTC/USDT:USDT] 平仓信号触发: 止盈-short (0.12%). 原模式: short, 入场价: 84354.6000, 当前价: 84243.5000
2025-04-27 23:53:34.885 | DEBUG    | MainThread      | backtest.engine:_handle_signal:871 | [2025-04-13 12:24:00+00:00|BTC/USDT:USDT] 信号: CLOSE. 平空仓 (Reason: 止盈-short (0.12%))...
2025-04-27 23:53:34.886 | DEBUG    | MainThread      | backtest.engine:_handle_signal:891 | [2025-04-13 12:24:00+00:00|BTC/USDT:USDT] 空仓已平. PnL: 0.9503, Comm: 0.0346, Cash: 24.9333
2025-04-27 23:53:34.899 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000160 (Thr:1e-05), VolConf:False
2025-04-27 23:53:34.939 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000143 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:34.984 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000193 > 1e-05, VolConf:True, EmaDiff:-0.0017
2025-04-27 23:53:35.040 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000045 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.096 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000052 > 1e-05, VolConf:True, EmaDiff:-0.0004
2025-04-27 23:53:35.145 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000044 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.176 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000195 > 1e-05, VolConf:True, EmaDiff:0.0006
2025-04-27 23:53:35.205 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:547 | [BTC/USDT:USDT] 死叉发生，但未满足任何模式条件。HistRatio:-0.000170 < -1e-05, VolConf:True, EmaDiff:0.0014
2025-04-27 23:53:35.264 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000241 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.281 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000087 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.311 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000061 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.321 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000002 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.335 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:483 | [BTC/USDT:USDT] 金叉发生，但未满足任何模式条件。HistRatio:0.000166 > 1e-05, VolConf:True, EmaDiff:-0.0025
2025-04-27 23:53:35.378 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000093 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.402 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000076 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.409 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000207 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.420 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000330 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.445 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000001 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.457 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000017 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.476 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000141 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.492 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000009 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.496 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:552 | [BTC/USDT:USDT] 死叉发生，但强度/成交量不足。HistRatio:-0.000106 (Thr:-1e-05), VolConf:False
2025-04-27 23:53:35.514 | DEBUG    | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:488 | [BTC/USDT:USDT] 金叉发生，但强度/成交量不足。HistRatio:0.000147 (Thr:1e-05), VolConf:False
2025-04-27 23:53:35.536 | INFO     | MainThread      | strategies.mystrategy:_generate_signal_for_symbol:564 | [BTC/USDT:USDT] 死叉-短线模式(空)(优化) 信号触发 @ 83255.8000, 模式: short
2025-04-27 23:53:35.537 | DEBUG    | MainThread      | backtest.engine:_handle_signal:785 | [2025-04-13 23:03:00+00:00|BTC/USDT:USDT] 信号: SELL. 开空仓 (Reason: 死叉-短线模式(空)(优化))...
2025-04-27 23:53:35.538 | DEBUG    | MainThread      | backtest.engine:_handle_signal:834 | [2025-04-13 23:03:00+00:00|BTC/USDT:USDT] 空仓已开. Amount: 0.008984, Price: 83255.8000, Comm: 0.0359, Cash: 24.8974
2025-04-27 23:53:37.853 | ERROR    | MainThread      | backtest.engine:_run_event_loop:600 | [2025-04-15 13:45:00+00:00] 账户权益耗尽 (-2.87)！回测提前终止。
2025-04-27 23:53:37.853 | INFO     | MainThread      | backtest.engine:_run_event_loop:606 | 回测事件循环完成。耗时: 4.97 秒。
2025-04-27 23:53:37.853 | INFO     | MainThread      | backtest.engine:_calculate_results:986 | 计算回测结果...
2025-04-27 23:53:37.858 | INFO     | MainThread      | backtest.results:calculate_metrics:112 | 回测周期约 0.01 年，计算年化指标...
2025-04-27 23:53:38.471 | WARNING  | MainThread      | backtest.results:calculate_metrics:118 | 计算年化回报 (CAGR) 失败: unsupported operand type(s) for /: 'int' and 'NoneType'
2025-04-27 23:53:38.472 | WARNING  | MainThread      | backtest.results:calculate_metrics:124 | 计算年化波动率失败: loop of ufunc does not support argument 0 of type NoneType which has no callable sqrt method
2025-04-27 23:53:38.475 | WARNING  | MainThread      | backtest.results:calculate_metrics:165 | 年化回报或最大回撤未能成功计算，无法计算卡玛比率。
2025-04-27 23:53:38.476 | INFO     | MainThread      | database.sqlite:close:765 | 数据库连接已关闭: C:\Users\qingf\Documents\lianghua\trader\future_trade\trading.db
2025-04-27 23:53:38.476 | INFO     | MainThread      | trading.api:close:368 | 正在关闭交易所 xt 的 WebSocket 连接...
2025-04-27 23:53:38.727 | INFO     | MainThread      | trading.api:close:370 | 交易所 xt WebSocket 连接已关闭
2025-04-27 23:53:38.727 | INFO     | MainThread      | __main__:main:193 | 回测完成，总耗时: 10.69 秒。
2025-04-27 23:53:38.728 | INFO     | MainThread      | __main__:<module>:243 | 回测程序执行完毕。
